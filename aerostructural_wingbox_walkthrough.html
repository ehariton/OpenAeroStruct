
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Aerostructural with Wingbox Walkthrough &#8212; OpenAeroStruct 2.1.0 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="More Examples" href="more_examples.html" />
    <link rel="prev" title="Aerostructural Walkthrough" href="aerostructural_walkthrough.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="more_examples.html" title="More Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="aerostructural_walkthrough.html" title="Aerostructural Walkthrough"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenAeroStruct 2.1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_example.html">Quick Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="aero_walkthrough.html">Aerodynamic Optimization Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="struct_example.html">Structural Optimization Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="aerostructural_walkthrough.html">Aerostructural Walkthrough</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Aerostructural with Wingbox Walkthrough</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="more_examples.html">More Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="specialty_topics.html">Specialty Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="v1_v2_conversion.html">OpenAeroStruct v1 to v2 Conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_contribute.html">How to Contribute to OpenAeroStruct</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_srcdocs/index.html">Source Docs</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="aerostructural-with-wingbox-walkthrough">
<span id="id1"></span><h1>Aerostructural with Wingbox Walkthrough<a class="headerlink" href="#aerostructural-with-wingbox-walkthrough" title="Permalink to this headline">¶</a></h1>
<p>In addition to the tubular-spar structural model available in OpenAeroStruct, you can use a wingbox-based model.
This model is described in Chauhan and Martins’ paper <a class="reference external" href="https://www.researchgate.net/publication/325986597_Low-fidelity_aerostructural_optimization_of_aircraft_wings_with_a_simplified_wingbox_model_using_OpenAeroStruct">here</a>.
We strongly recommend reading this relatively short conference paper to learn about the model and see some example results.
Analytic derivatives are not provided for some components of this model, so any optimization problem will use the complex-step approximation to obtain the relevant partial derivatives for these components.</p>
<img alt="_images/wingbox_fine.png" src="_images/wingbox_fine.png" />
<p>This page breaks down and describes an example optimization run-script that uses the wingbox model.
This example uses the same optimization problem used for the paper linked above, but with fewer design variables and a coarser mesh.
The wing being optimized is based on the undeflected Common Research Model (uCRM), which is a long-range transport aircraft.
A script to replicate the optimization problems described in the paper can be found in the examples directory (openaerostruct/examples/run_aerostruct_uCRM_multipoint.py).
Please contact Shamsheer Chauhan (<a class="reference external" href="mailto:sschau&#37;&#52;&#48;umich&#46;edu">sschau<span>&#64;</span>umich<span>&#46;</span>edu</a>) with any questions you have after reading the above paper and going through this example.</p>
<p>The goal of the wingbox model is to allow more realistic preliminary structural sizing for commuter to long-range transport-type aircraft which typically have wingbox structures.
Since more realistic sizing is one of the goals of the wingbox model, this example also shows how to use it with a multipoint optimization.
Wing structures are usually sized using loads that do not occur during normal cruise conditions, so we must consider at least one more flight point that provides more extreme loads.</p>
<p>This tutorial assumes that the reader has gone through the other examples and tutorials in the OpenAeroStruct documentation and is now familiar with how to set up problems and the terminology of OpenAeroStruct.</p>
<p>Let’s begin and look at the run-script now. First we import some modules.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">openaerostruct.geometry.utils</span> <span class="k">import</span> <span class="n">generate_mesh</span>
<span class="kn">from</span> <span class="nn">openaerostruct.integration.aerostruct_groups</span> <span class="k">import</span> <span class="n">AerostructGeometry</span><span class="p">,</span> <span class="n">AerostructPoint</span>
<span class="kn">from</span> <span class="nn">openmdao.api</span> <span class="k">import</span> <span class="n">IndepVarComp</span><span class="p">,</span> <span class="n">Problem</span><span class="p">,</span> <span class="n">ScipyOptimizeDriver</span><span class="p">,</span> <span class="n">SqliteRecorder</span><span class="p">,</span> <span class="n">ExecComp</span>
<span class="kn">from</span> <span class="nn">openaerostruct.structures.wingbox_fuel_vol_delta</span> <span class="k">import</span> <span class="n">WingboxFuelVolDelta</span>
<span class="kn">from</span> <span class="nn">openaerostruct.utils.constants</span> <span class="k">import</span> <span class="n">grav_constant</span>

</pre></div>
</div>
<p>Next, we provide some airfoil coordinates.
These coordinates are used to define the shape of the wingbox cross-section.
In this example, we use the NASA SC2-0612 coordinates from airfoiltools.com.
However, here we only provide the coordinates for the 10%- to 60%-chord portion of the airfoil because for this example we assume that it is this portion of the chord along the wing that will be structural and form the wingbox.
Make sure that the first and last x-coordinates (chordwise) of the upper and lower curves are the same.
Also make sure that the chord length of the original airfoil has been normalized to 1 (this is normally the case for the airfoil coordinates available on airfoiltools.com).</p>
<p>These coordinates will be scaled based on the effective chord and thickness-to-chord ratio for each wingbox segment along the wing.
However, we currently have not implemented the functionality to specify different airfoil coordinates for different segments of the wing, so the same coordinates are used for the entire wing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Provide coordinates for a portion of an airfoil for the wingbox cross-section as an nparray with dtype=complex (to work with the complex-step approximation for derivatives).</span>
<span class="c1"># These should be for an airfoil with the chord scaled to 1.</span>
<span class="c1"># We use the 10% to 60% portion of the NASA SC2-0612 airfoil for this case</span>
<span class="c1"># We use the coordinates available from airfoiltools.com. Using such a large number of coordinates is not necessary.</span>
<span class="c1"># The first and last x-coordinates of the upper and lower surfaces must be the same</span>

<span class="n">upper_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.36</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
<span class="n">lower_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.36</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
<span class="n">upper_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.0447</span><span class="p">,</span>  <span class="mf">0.046</span><span class="p">,</span>  <span class="mf">0.0472</span><span class="p">,</span>  <span class="mf">0.0484</span><span class="p">,</span>  <span class="mf">0.0495</span><span class="p">,</span>  <span class="mf">0.0505</span><span class="p">,</span>  <span class="mf">0.0514</span><span class="p">,</span>  <span class="mf">0.0523</span><span class="p">,</span>  <span class="mf">0.0531</span><span class="p">,</span>  <span class="mf">0.0538</span><span class="p">,</span> <span class="mf">0.0545</span><span class="p">,</span>  <span class="mf">0.0551</span><span class="p">,</span>  <span class="mf">0.0557</span><span class="p">,</span> <span class="mf">0.0563</span><span class="p">,</span>  <span class="mf">0.0568</span><span class="p">,</span> <span class="mf">0.0573</span><span class="p">,</span>  <span class="mf">0.0577</span><span class="p">,</span>  <span class="mf">0.0581</span><span class="p">,</span>  <span class="mf">0.0585</span><span class="p">,</span>  <span class="mf">0.0588</span><span class="p">,</span>  <span class="mf">0.0591</span><span class="p">,</span>  <span class="mf">0.0593</span><span class="p">,</span>  <span class="mf">0.0595</span><span class="p">,</span>  <span class="mf">0.0597</span><span class="p">,</span>  <span class="mf">0.0599</span><span class="p">,</span>  <span class="mf">0.06</span><span class="p">,</span>    <span class="mf">0.0601</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0601</span><span class="p">,</span>  <span class="mf">0.06</span><span class="p">,</span>    <span class="mf">0.0599</span><span class="p">,</span>  <span class="mf">0.0598</span><span class="p">,</span>  <span class="mf">0.0596</span><span class="p">,</span>  <span class="mf">0.0594</span><span class="p">,</span>  <span class="mf">0.0592</span><span class="p">,</span>  <span class="mf">0.0589</span><span class="p">,</span>  <span class="mf">0.0586</span><span class="p">,</span>  <span class="mf">0.0583</span><span class="p">,</span>  <span class="mf">0.058</span><span class="p">,</span>   <span class="mf">0.0576</span><span class="p">,</span>  <span class="mf">0.0572</span><span class="p">,</span>  <span class="mf">0.0568</span><span class="p">,</span>  <span class="mf">0.0563</span><span class="p">,</span>  <span class="mf">0.0558</span><span class="p">,</span>  <span class="mf">0.0553</span><span class="p">,</span>  <span class="mf">0.0547</span><span class="p">,</span>  <span class="mf">0.0541</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
<span class="n">lower_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.0447</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.046</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0473</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0485</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0496</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0506</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0515</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0524</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0532</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.054</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0547</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0554</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.056</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0565</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.057</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0575</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0579</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0583</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0586</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0589</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0592</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0594</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0595</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0596</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0596</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0594</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0592</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0589</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0586</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0582</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0578</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0573</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0567</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0561</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0554</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0546</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0538</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0529</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0519</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0509</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0497</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0485</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0472</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0458</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0444</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Next, we create the dictionary with information for the mesh and create the mesh.
For this example we use the uCRM-based geometry (undeflected Common Research Model) already defined and available in OpenAeroStruct.
Alternatively, the user can provide their own mesh (see <a class="reference internal" href="more_examples/aerostructural_wingbox_Q400.html#aerostructural-with-wingbox-q400"><span class="std std-ref">Aerostructural with wingbox (Q400)</span></a> for another example with a custom mesh).
Here we specify 15 as the number of spanwise nodes and 3 as the number of chordwise nodes for the VLM mesh.
We also set <cite>chord_cos_spacing</cite> and <cite>span_cos_spacing</cite> to <cite>0</cite> for uniform panel spacing.
The FEM model will use the spanwise spacing of the VLM mesh for the FEM mesh.
We use a very coarse mesh for this example to keep the computational time low.</p>
<p>The <cite>generate_mesh</cite> function takes the inputs from the mesh dictionary and returns the mesh as well as values for the B-spline control points for the twist distribution (we specify the number of control points for this using <cite>num_twist_cp</cite> in the dictionary).
Note that in this example we don’t end up using this twist distribution, but instead use a better starting twist distribution which will be seen later.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Create a dictionary to store options about the surface</span>
<span class="n">mesh_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;num_y&#39;</span> <span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
             <span class="s1">&#39;num_x&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
             <span class="s1">&#39;wing_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;uCRM_based&#39;</span><span class="p">,</span>
             <span class="s1">&#39;symmetry&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
             <span class="s1">&#39;chord_cos_spacing&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="s1">&#39;span_cos_spacing&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="s1">&#39;num_twist_cp&#39;</span> <span class="p">:</span> <span class="mi">4</span>
             <span class="p">}</span>

<span class="n">mesh</span><span class="p">,</span> <span class="n">twist_cp</span> <span class="o">=</span> <span class="n">generate_mesh</span><span class="p">(</span><span class="n">mesh_dict</span><span class="p">)</span>

</pre></div>
</div>
<p>Next, we create a surface dictionary and provide necessary information for our lifting surface.
After providing the relevant information for the <cite>name</cite>, <cite>symmetry</cite>, and <cite>S_ref_type</cite> settings, we provide the mesh and specify the string <cite>‘wingbox’</cite> for the <cite>fem_model_type</cite> (if we wanted the tubular structure, we would specify <cite>‘tube’</cite> instead).
We also provide the airfoil coordinates for the wingbox cross-section here as the four arrays defined earlier.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">surf_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># Wing definition</span>
            <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;wing&#39;</span><span class="p">,</span>         <span class="c1"># give the surface some name</span>
            <span class="s1">&#39;symmetry&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>       <span class="c1"># if True, model only one half of the lifting surface</span>
            <span class="s1">&#39;S_ref_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;projected&#39;</span><span class="p">,</span> <span class="c1"># how we compute the wing area,</span>
                                     <span class="c1"># can be &#39;wetted&#39; or &#39;projected&#39;</span>
            <span class="s1">&#39;mesh&#39;</span> <span class="p">:</span> <span class="n">mesh</span><span class="p">,</span>

            <span class="s1">&#39;fem_model_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;wingbox&#39;</span><span class="p">,</span> <span class="c1"># &#39;wingbox&#39; or &#39;tube&#39;</span>
            <span class="s1">&#39;data_x_upper&#39;</span> <span class="p">:</span> <span class="n">upper_x</span><span class="p">,</span>
            <span class="s1">&#39;data_x_lower&#39;</span> <span class="p">:</span> <span class="n">lower_x</span><span class="p">,</span>
            <span class="s1">&#39;data_y_upper&#39;</span> <span class="p">:</span> <span class="n">upper_y</span><span class="p">,</span>
            <span class="s1">&#39;data_y_lower&#39;</span> <span class="p">:</span> <span class="n">lower_y</span><span class="p">,</span>

</pre></div>
</div>
<p>Next, we provide some initial values for the wingbox spar and skin thickness distributions (B-spline control points), along with the wing twist distribution (note that these distributions do not need to have the same number of control points).
For the wingbox model, to maintain simplicity, we use the same thickness variables for both the top and bottom wing skins.
Similarly, we use the same thickness variables for the front and rear spars.
Currently, we do not model buckling or have any buckling constraints.
However, a comparison of optimized skin thicknesses with high-fidelity results shown in these <a class="reference external" href="https://www.researchgate.net/publication/327802989_Presentation_slides_for_Low-fidelity_Aerostructural_Optimization_of_Aircraft_Wings_with_a_Simplified_Wingbox_Model_Using_OpenAeroStruct">slides</a>, indicates that, assuming the wing has a reasonable rib spacing, this is not a very major concern.</p>
<p>We also provide a distribution for the thickness-to-chord ratio (B-spline control points for <cite>t_over_c_cp</cite>).
The thickness-to-chord ratio design variable is important for the trade-off between aerodynamic (wave and viscous drag) benefits from a thin wing and structural benefits from a thick wing.
The <cite>original_wingbox_airfoil_t_over_c</cite> is the thickness-to-chord ratio of the airfoil provided for the wingbox cross-section.
For this example, the thickness-to-chord ratio of the SC2-0612 is 12%.
This is used to scale the airfoil in the thickness direction as the thickness-to-chord ratio variable changes.
Note that the thickness-to-chord ratio variable is the streamwise value.
Using the sweep angle for the wingbox elements OpenAeroStruct computes the effective values for the wingbox cross-sections normal to the elements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
            <span class="s1">&#39;twist_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">]),</span> <span class="c1"># [deg]</span>

            <span class="s1">&#39;spar_thickness_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]),</span> <span class="c1"># [m]</span>
            <span class="s1">&#39;skin_thickness_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">]),</span> <span class="c1"># [m]</span>

            <span class="s1">&#39;t_over_c_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">]),</span>
            <span class="s1">&#39;original_wingbox_airfoil_t_over_c&#39;</span> <span class="p">:</span> <span class="mf">0.12</span><span class="p">,</span>

</pre></div>
</div>
<p>Next, we provide some information related to aerodynamics and specify some options.
We set <cite>CDO</cite> to 0.0078 to account for the drag from the fuselage, tail surfaces, nacelles, and pylons (which are not being modeled).
We set <cite>with_viscous</cite> to <cite>True</cite> to make OpenAeroStruct include an estimate for viscous drag (empirical equations) when computing the drag of the wing.
We set <cite>with_wave</cite> to <cite>True</cite> to make OpenAeroStruct also include an estimate for wave drag using the empirical equations based on the Korn equation.
This wave drag estimate needs a thickness-to-chord ratio value and a sweep angle value for the wing.
This is computed internally by averaging the thickness-to-chord ratios and sweep angles across the span of the wing weighted by the widths of the corresponding VLM panels.
Keep this in mind when creating wing meshes and setting up optimization problems using the wingbox model.
The optimizer may try to take advantage of this averaging.</p>
<p>The <cite>k_lam</cite> value is the fraction of the chord assumed to have laminar flow, and is used for OpenAeroStruct’s viscous drag estimates (empirical equations).
The <cite>c_max_t</cite> value is the location of the maximum thickness of the airfoil along the chord, and is also used for OpenAeroStruct’s viscous drag estimates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
            <span class="c1"># Aerodynamic deltas.</span>
            <span class="c1"># These CL0 and CD0 values are added to the CL and CD</span>
            <span class="c1"># obtained from aerodynamic analysis of the surface to get</span>
            <span class="c1"># the total CL and CD.</span>
            <span class="c1"># These CL0 and CD0 values do not vary wrt alpha.</span>
            <span class="c1"># They can be used to account for things that are not included, such as contributions from the fuselage, camber, etc.</span>
            <span class="s1">&#39;CL0&#39;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>            <span class="c1"># CL delta</span>
            <span class="s1">&#39;CD0&#39;</span> <span class="p">:</span> <span class="mf">0.0078</span><span class="p">,</span>         <span class="c1"># CD delta</span>

            <span class="s1">&#39;with_viscous&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># if true, compute viscous drag</span>
            <span class="s1">&#39;with_wave&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>     <span class="c1"># if true, compute wave drag</span>

            <span class="c1"># Airfoil properties for viscous drag calculation</span>
            <span class="s1">&#39;k_lam&#39;</span> <span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>         <span class="c1"># fraction of chord with laminar</span>
                                    <span class="c1"># flow, used for viscous drag</span>
            <span class="s1">&#39;c_max_t&#39;</span> <span class="p">:</span> <span class="o">.</span><span class="mi">38</span><span class="p">,</span>       <span class="c1"># chordwise location of maximum thickness</span>

</pre></div>
</div>
<p>Next we provide some information related to structures.
We provide the Young’s and shear moduli, as well as the allowable yield stress and density of the material being used (the wingbox model currently assumes that the material is isotropic).
Here we use include a safety factor of 1.5 in the allowable yield stress.
The <cite>strength_factor_for_upper_skin</cite> value can be used to adjust the yield strength of the upper skin relative to the lower skin.
For example, if we were using different alloys for the top and bottom skin (e.g., Al7075 vs Al2024) we would provide the allowable yield stress of the lower skin for <cite>yield</cite> and the ratio of the yield strengths of the upper skin to the lower skin for <cite>strength_factor_for_upper_skin</cite>.
The <cite>wing_weight_ratio</cite> number is used to estimate the weight of other components not modeled in the wingbox structure (e.g., overlaps, fasteners, etc.).
With the <cite>exact_failure_constraint</cite> set to <cite>False</cite>, we aggregate the stress constraints for the FEM elements into a single constraint using the  Kreisselmeier–Steinhauser function.
This helps reduce computational cost during optimization by replacing a large number of constraints (one for each stress combination for each element) with a single constraint.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
            <span class="c1"># Structural values are based on aluminum 7075</span>
            <span class="s1">&#39;E&#39;</span> <span class="p">:</span> <span class="mf">73.1e9</span><span class="p">,</span>              <span class="c1"># [Pa] Young&#39;s modulus</span>
            <span class="s1">&#39;G&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mf">73.1e9</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mf">1.33</span><span class="p">),</span>     <span class="c1"># [Pa] shear modulus (calculated using E and the Poisson&#39;s ratio here)</span>
            <span class="s1">&#39;yield&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mf">420.e6</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">),</span>  <span class="c1"># [Pa] allowable yield stress</span>
            <span class="s1">&#39;mrho&#39;</span> <span class="p">:</span> <span class="mf">2.78e3</span><span class="p">,</span>           <span class="c1"># [kg/m^3] material density</span>
            <span class="s1">&#39;strength_factor_for_upper_skin&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="c1"># the yield stress is multiplied by this factor for the upper skin</span>

            <span class="s1">&#39;wing_weight_ratio&#39;</span> <span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span>
            <span class="s1">&#39;exact_failure_constraint&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="c1"># if false, use KS function</span>

</pre></div>
</div>
<p>The next two options <cite>struct_weight_relief</cite> and <cite>distributed_fuel_weight</cite> are used to specify whether the user wants the loads from the weight of the wingbox structure and the weight of the fuel to be distributed on the wing structure to provide load relief.
The <cite>struct_weight_relief</cite> is for the loads from the weight of the structure (including the <cite>wing_weight_ratio</cite> factor).
The <cite>distributed_fuel_weight</cite> is for the loads from the weight of the fuel, which is assumed to be distributed across the entire wing (the fraction of the total fuel that each wingbox segment, corresponding to each finite element, holds is equal to the ratio of its enclosed volume to the total enclosed volume of all the wingbox segments).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
            <span class="s1">&#39;struct_weight_relief&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;distributed_fuel_weight&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>

</pre></div>
</div>
<p>Next, we specify the density of the fuel (used to compute fuel volume from fuel mass) and also specify how much fuel we are carrying as reserves.
This reserve fuel weight is added to the weight of the aircraft for performance calculations as well as computing the loads from the fuel on the wing when using the <cite>distributed_fuel_weight</cite> option.
With these two final options, we are done with the surface dictionary and add it to a list called surfaces (here we only have one surface, but in general we might have multiple).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
            <span class="s1">&#39;fuel_density&#39;</span> <span class="p">:</span> <span class="mf">803.</span><span class="p">,</span>      <span class="c1"># [kg/m^3] fuel density (only needed if the fuel-in-wing volume constraint is used)</span>
            <span class="s1">&#39;Wf_reserve&#39;</span> <span class="p">:</span><span class="mf">15000.</span><span class="p">,</span>       <span class="c1"># [kg] reserve fuel mass</span>

            <span class="p">}</span>

<span class="n">surfaces</span> <span class="o">=</span> <span class="p">[</span><span class="n">surf_dict</span><span class="p">]</span>

</pre></div>
</div>
<p>Next, we instantiate the OpenMDAO <cite>Problem</cite> and specify the independent variables.
We will use some of these variables later as design variables and some simply as inputs.
First we provide some inputs related to the flight conditions (Mach number, airspeed, Reynolds number per unit length, air density, and speed of sound).
Since we want to consider two flight points in this example (a nominal cruise case and a 2.5g maneuver case), we provide two values for each input that is different for the two cases.
For example, our cruise Mach number is 0.85 and our maneuver Mach number is 0.64.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Create the problem and assign the model group</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">()</span>

<span class="c1"># Add problem information as an independent variables component</span>
<span class="n">indep_var_comp</span> <span class="o">=</span> <span class="n">IndepVarComp</span><span class="p">()</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;Mach_number&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.64</span><span class="p">]))</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">85</span> <span class="o">*</span> <span class="mf">295.07</span><span class="p">,</span> <span class="o">.</span><span class="mi">64</span> <span class="o">*</span> <span class="mf">340.294</span><span class="p">]),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;re&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.348</span><span class="o">*</span><span class="mf">295.07</span><span class="o">*.</span><span class="mi">85</span><span class="o">*</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.43</span><span class="o">*</span><span class="mf">1e-5</span><span class="p">),</span> \
                          <span class="mf">1.225</span><span class="o">*</span><span class="mf">340.294</span><span class="o">*.</span><span class="mi">64</span><span class="o">*</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.81206</span><span class="o">*</span><span class="mf">1e-5</span><span class="p">)]),</span>  <span class="n">units</span><span class="o">=</span><span class="s1">&#39;1/m&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.348</span><span class="p">,</span> <span class="mf">1.225</span><span class="p">]),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg/m**3&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;speed_of_sound&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">295.07</span><span class="p">,</span> <span class="mf">340.294</span><span class="p">]),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>The following are some more independent variables.
We have the thrust-specific fuel consumption, <cite>CT</cite>, cruise range, <cite>R</cite>, and the weight of the aircraft without the fuel required for the cruise point and without the weight of the wing structure, <cite>W0</cite>.
Since we are not interested in the fuel burn or range at the maneuver point, we only provide a single value for these inputs that will be used for the cruise fuel burn.
Note that <cite>W0</cite> includes the reserve fuel weight, which is why it is added here.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;CT&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.53</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;1/s&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">14.307e6</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;W0&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mi">148000</span> <span class="o">+</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;Wf_reserve&#39;</span><span class="p">],</span>  <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Next, we specify the load factor for each flight point (1g for cruise and 2.5g for the maneuver case).
We also provide values for the angle of attack.
In this case, instead of providing two values as an array for one variable, we add two separate variables with different names (<cite>alpha</cite> and <cite>alpha_maneuver</cite>).
We create two variables just for convenience because, for this example, we allow the optimizer to trim the aircraft for the maneuver case using the angle of attack for that flight point (by making it a design variable), but keep the angle of attack fixed for the cruise case and make the optimizer trim the aircraft for the cruise flight point using the twist distribution.
We also include the empty center of gravity location here as a reminder that we could use it later for studies in which we include tail surfaces and consider pitching moments (not done in this example).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;load_factor&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">]))</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;alpha_maneuver&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>

<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;empty_cg&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">)),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Finally, we also add the fuel mass as an independent variable to use it as a design variable.
This may seem like a strange design variable to have, but we do this from an optimization architecture point of view.
Instead of directly transferring the fuel burn value from the cruise point to the maneuver point (used to calculate MTOW for the maneuver point), we instead create a constraint (shown later) and make the optimizer ensure that the value being used for the fuel mass is the same value that is computed in the cruise point.
This also allows the flexibility to later decide that you want to use a different value for the fuel mass for the maneuver case (or any other flight point you may have) that does not depend on the cruise point (or any other flight point you may have).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">10000.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;prob_vars&#39;</span><span class="p">,</span>
     <span class="n">indep_var_comp</span><span class="p">,</span>
     <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>

</pre></div>
</div>
<p>Next, we instantiate aerostructual <cite>groups</cite> for each surface (only one in this example) and add them to the model.
We use a loop for generality but it is not necessary for this example because we only have one surface (just the wing).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Loop over each surface in the surfaces list</span>
<span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>

    <span class="c1"># Get the surface name and create a group to contain components</span>
    <span class="c1"># only for this surface</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">surface</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

    <span class="n">aerostruct_group</span> <span class="o">=</span> <span class="n">AerostructGeometry</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">)</span>

    <span class="c1"># Add groups to the problem with the name of the surface.</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">aerostruct_group</span><span class="p">)</span>

</pre></div>
</div>
<p>Now we have to instantiate aerostructural flight points (one for cruise and one for the maneuver case in this example), add them to the model, and after that connect the inputs to the points.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Loop through and add a certain number of aerostruct points</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>

    <span class="n">point_name</span> <span class="o">=</span> <span class="s1">&#39;AS_point_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># Connect the parameters within the model for each aero point</span>

    <span class="c1"># Create the aerostruct point group and add it to the model</span>
    <span class="n">AS_point</span> <span class="o">=</span> <span class="n">AerostructPoint</span><span class="p">(</span><span class="n">surfaces</span><span class="o">=</span><span class="n">surfaces</span><span class="p">,</span> <span class="n">internally_connect_fuelburn</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="n">point_name</span><span class="p">,</span> <span class="n">AS_point</span><span class="p">)</span>

</pre></div>
</div>
<p>Here we make connect the inputs to the flight points.
For the inputs that have different values for each flight point, we also specify the <cite>src_indices</cite> to specify which one of the input values to use.
In some connections you may notice slightly different naming.
For example, for the air density we write <cite>‘rho’, point_name + ‘.rho’</cite>, but for the fuel mass we write <cite>‘fuel_mass’, point_name + ‘.total_perf.L_equals_W.fuelburn’</cite>.
This has to do with how the variables belonging to different components and groups have been promoted (i.e., which level in the hierarchy they are available at).
If you are unsure about where variables have been promoted to, while making connections on your own later, use OpenMDAO’s feature for visualizing the N2 diagram (commands shown later).
Hovering over variables in this diagram should tell you what names to use for them.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
    <span class="c1"># Connect flow properties to the analysis point</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.v&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;Mach_number&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.Mach_number&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;re&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.re&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.rho&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;CT&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.CT&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.R&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;W0&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.W0&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;speed_of_sound&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.speed_of_sound&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;empty_cg&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.empty_cg&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;load_factor&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.load_factor&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.total_perf.L_equals_W.fuelburn&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.total_perf.CG.fuelburn&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Now we have to make a few more internal connections that are not made automatically.
Once again, if you are unsure about whether variables have been connected correctly, use OpenMDAO’s N2 diagram visualization feature (commands shown later).
That diagram should show the connections, and the variables that have not been connected will be highlighted in red.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
    <span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">surface</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;distributed_fuel_weight&#39;</span><span class="p">]:</span>
            <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;load_factor&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.load_factor&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">com_name</span> <span class="o">=</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_perf.&#39;</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.local_stiff_transformed&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.local_stiff_transformed&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.nodes&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.nodes&#39;</span><span class="p">)</span>

        <span class="c1"># Connect aerodyamic mesh to coupled group mesh</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.mesh&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.mesh&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;struct_weight_relief&#39;</span><span class="p">]:</span>
            <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.element_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.element_mass&#39;</span><span class="p">)</span>

        <span class="c1"># Connect performance calculation variables</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.nodes&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;nodes&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.cg_location&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="s1">&#39;total_perf.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_cg_location&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.structural_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="s1">&#39;total_perf.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_structural_mass&#39;</span><span class="p">)</span>

        <span class="c1"># Connect wingbox properties to von Mises stress calcs</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.Qz&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;Qz&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.J&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;J&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.A_enc&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;A_enc&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.htop&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;htop&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hbottom&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;hbottom&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hfront&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;hfront&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hrear&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;hrear&#39;</span><span class="p">)</span>

        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.spar_thickness&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;spar_thickness&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.t_over_c&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;t_over_c&#39;</span><span class="p">)</span>


</pre></div>
</div>
<p>We have a couple more connections to make outside the loop because of the variable naming.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0&#39;</span> <span class="o">+</span> <span class="s1">&#39;.alpha&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;alpha_maneuver&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1&#39;</span> <span class="o">+</span> <span class="s1">&#39;.alpha&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>For this example, we are also interested in adding a fuel-volume constraint that makes sure that the wingbox has enough internal volume to store the required fuel mass (estimated from the cruise flight point plus the reserve fuel).
First we instantiate and add the component that computes the difference between the available internal volume and the required fuel volume (<cite>WingboxFuelVolDelta</cite>).
Then we make some connections.
We connect the fuel burn computed from the cruise condition to this component because we are interested in the fuel burn value from the cruise condition.
We also have an <cite>if</cite> statement to make some more connections if we want the loads from the weight of the fuel to be applied to the FEM model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Here we add the fuel volume constraint componenet to the model</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;fuel_vol_delta&#39;</span><span class="p">,</span> <span class="n">WingboxFuelVolDelta</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">))</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;wing.struct_setup.fuel_vols&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_vol_delta.fuel_vols&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_vol_delta.fuelburn&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;distributed_fuel_weight&#39;</span><span class="p">]:</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;wing.struct_setup.fuel_vols&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0.coupled.wing.struct_states.fuel_vols&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0.coupled.wing.struct_states.fuel_mass&#39;</span><span class="p">)</span>

    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;wing.struct_setup.fuel_vols&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1.coupled.wing.struct_states.fuel_vols&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1.coupled.wing.struct_states.fuel_mass&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Next, we use OpenMDAO’s ExecComp feature (which can be used to quickly create simple components) to create a component that is used later for the constraint that ensures that the fuel mass value (used to compute the aircraft weight and fuel loads) is the same as the fuel burn mass computed from the cruise point (i.e., AS_point_0 here).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">comp</span> <span class="o">=</span> <span class="n">ExecComp</span><span class="p">(</span><span class="s1">&#39;fuel_diff = (fuel_mass - fuelburn) / fuelburn&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;fuel_diff&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span>
    <span class="n">promotes_inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">],</span>
    <span class="n">promotes_outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fuel_diff&#39;</span><span class="p">])</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_diff.fuelburn&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Now it is time to specify the objective function and design variables.
For this example, the objective function is the fuel burn computed using the cruise point (AS_point_0).
The design variables are the control points for the twist, spar thickness, skin thickness, and thickness-to-chord ratio distributions.
We add these design variables along with upper and lower bounds, and scalers.
The scalers are used to scale the values of the design variables to help the optimizer converge better.
Usually a scaler that brings the design variable to an order of magnitude around 1 is recommended.
We also have a design variable for the maneuver angle of attack.
In this example, the cruise angle of attack (which rotates the entire wing) is fixed at 0 and the optimizer uses the twist distribution to trim the aircraft for cruise.
Then using this same twist distribution, the maneuver case is trimmed using the maneuver angle of attack design variable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.twist_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mf">15.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">15.</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.spar_thickness_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.skin_thickness_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.geometry.t_over_c_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;alpha_maneuver&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mf">15.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

</pre></div>
</div>
<p>Next we add some constraints.
For the cruise point, we specify a nominal coefficient of lift of 0.5.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;AS_point_0.CL&#39;</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

</pre></div>
</div>
<p>For the maneuver point, we use the following constraints to ensure that the lift equals the weight, and that the stresses in the structure do not exceed the specified allowable value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;AS_point_1.L_equals_W&#39;</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;AS_point_1.wing_perf.failure&#39;</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

</pre></div>
</div>
<p>For this example, we also add a constraint that ensures that the wingbox has enough internal volume for the fuel.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;fuel_vol_delta.fuel_vol_delta&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

</pre></div>
</div>
<p>Now we add <cite>fuel_mass</cite> as a design variable and add the consistency constraint that ensures that the fuel mass value is the same as the fuel burn mass computed from the cruise point.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">2e5</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;fuel_diff&#39;</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

</pre></div>
</div>
<p>Next, we specify an optimizer and its tolerance.
Here we use the easily available SLSQP optimizer from SciPy and specify a very low tolerance to keep the computational cost very low for the purposes of this example.
We recommend that the user experiments with tolerances and uses much tighter tolerances for their studies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">ScipyOptimizeDriver</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;optimizer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SLSQP&#39;</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;tol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-2</span>

</pre></div>
</div>
<p>We also include the following recorder settings so that OpenMDAO stores the optimization history in a database that can be used with the plot_wingbox.py visualization script in the <cite>utils</cite> sub-directory.
It isn’t necessary to specify the long list of variables (<cite>prob.driver.recording_options[‘includes’]</cite>), and instead we could just use <cite>prob.driver.recording_options[‘includes’] = [‘*’]</cite> to include all variables.
However, for finer meshes, the database becomes extremely large and the visualization script does not work due to memory requirements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="n">recorder</span> <span class="o">=</span> <span class="n">SqliteRecorder</span><span class="p">(</span><span class="s2">&quot;aerostruct.db&quot;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_recorder</span><span class="p">(</span><span class="n">recorder</span><span class="p">)</span>

<span class="c1"># We could also just use prob.driver.recording_options[&#39;includes&#39;]=[&#39;*&#39;] here, but for large meshes the database file becomes extremely large. So we just select the variables we need.</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;includes&#39;</span><span class="p">]</span> <span class="o">=</span> \
<span class="p">[</span><span class="s1">&#39;prob_vars.alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;prob_vars.rho&#39;</span><span class="p">,</span> <span class="s1">&#39;prob_vars.v&#39;</span><span class="p">,</span> <span class="s1">&#39;prob_vars.cg&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_1.total_perf.CG.cg&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0.total_perf.CG.cg&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.coupled.wing_loads.loads&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1.coupled.wing_loads.loads&#39;</span><span class="p">,</span> \
<span class="s1">&#39;wing.wingbox_group.skin_thickness_bsp.skin_thickness&#39;</span><span class="p">,</span> \
<span class="s1">&#39;wing.geometry.mesh.rotate.mesh&#39;</span><span class="p">,</span>\
<span class="s1">&#39;wing.wingbox_group.spar_thickness_bsp.spar_thickness&#39;</span><span class="p">,</span> \
<span class="s1">&#39;wing.wingbox_group.spar_thickness_bsp.spar_thickness&#39;</span><span class="p">,</span> \
<span class="s1">&#39;wing.geometry.t_over_c_bsp.t_over_c&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.wing_perf.struct_funcs.vonmises.vonmises&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_1.wing_perf.struct_funcs.vonmises.vonmises&#39;</span><span class="p">,</span> \
<span class="s1">&#39;wing.struct_setup.structural_mass.structural_mass&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.coupled.wing.def_mesh.displacement_transfer.def_mesh&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_1.coupled.wing.def_mesh.displacement_transfer.def_mesh&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.coupled.wing.aero_geom.normals&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_1.coupled.wing.aero_geom.normals&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.coupled.wing.aero_geom.widths&#39;</span><span class="p">,</span>  <span class="s1">&#39;AS_point_1.coupled.wing.aero_geom.widths&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.coupled.aero_states.panel_forces_surf.wing_sec_forces&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_1.coupled.aero_states.panel_forces_surf.wing_sec_forces&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.wing_perf.aero_funcs.coeffs.CL1&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1.wing_perf.aero_funcs.coeffs.CL1&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.coupled.wing.aero_geom.S_ref&#39;</span><span class="p">,</span>
<span class="s1">&#39;AS_point_1.coupled.wing.aero_geom.S_ref&#39;</span><span class="p">,</span>
<span class="s1">&#39;wing.geometry.twist_bsp.twist&#39;</span><span class="p">]</span>

<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_objectives&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_constraints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_desvars&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_inputs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

</pre></div>
</div>
<p>Finally, we call the usual commands to setup and run the optimization problem.
Notice that we also have some commands commented out.
The <cite>view_model</cite> command can be used to generate a .html script that can be opened with a web browser to visualize the N2 problem structure.
The <cite>check_partials</cite> command can be used to check partial derivatives when modifying or creating components.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Set up the problem</span>
<span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="c1"># from openmdao.api import view_model</span>
<span class="c1"># view_model(prob)</span>

<span class="c1"># prob.check_partials(form=&#39;central&#39;, compact_print=True)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">run_driver</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The fuel burn value is&#39;</span><span class="p">,</span> <span class="n">prob</span><span class="p">[</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[kg]&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The wingbox mass (excluding the wing_weight_ratio) is&#39;</span><span class="p">,</span> <span class="n">prob</span><span class="p">[</span><span class="s1">&#39;wing.structural_mass&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">grav_constant</span><span class="o">/</span><span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;wing_weight_ratio&#39;</span><span class="p">],</span> <span class="s1">&#39;[kg]&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Now we put the code together, run it, and see the output:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>

<span class="c1"># Ignore the #docs checkpoint comments. They are just used to split up the code for the documentation webpage.</span>
<span class="c1">#docs checkpoint 0</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">openaerostruct.geometry.utils</span> <span class="kn">import</span> <span class="n">generate_mesh</span>
<span class="kn">from</span> <span class="nn">openaerostruct.integration.aerostruct_groups</span> <span class="kn">import</span> <span class="n">AerostructGeometry</span><span class="p">,</span> <span class="n">AerostructPoint</span>
<span class="kn">from</span> <span class="nn">openmdao.api</span> <span class="kn">import</span> <span class="n">IndepVarComp</span><span class="p">,</span> <span class="n">Problem</span><span class="p">,</span> <span class="n">ScipyOptimizeDriver</span><span class="p">,</span> <span class="n">SqliteRecorder</span><span class="p">,</span> <span class="n">ExecComp</span>
<span class="kn">from</span> <span class="nn">openaerostruct.structures.wingbox_fuel_vol_delta</span> <span class="kn">import</span> <span class="n">WingboxFuelVolDelta</span>
<span class="kn">from</span> <span class="nn">openaerostruct.utils.constants</span> <span class="kn">import</span> <span class="n">grav_constant</span>

<span class="c1">#docs checkpoint 1</span>

<span class="c1"># Provide coordinates for a portion of an airfoil for the wingbox cross-section as an nparray with dtype=complex (to work with the complex-step approximation for derivatives).</span>
<span class="c1"># These should be for an airfoil with the chord scaled to 1.</span>
<span class="c1"># We use the 10% to 60% portion of the NASA SC2-0612 airfoil for this case</span>
<span class="c1"># We use the coordinates available from airfoiltools.com. Using such a large number of coordinates is not necessary.</span>
<span class="c1"># The first and last x-coordinates of the upper and lower surfaces must be the same</span>

<span class="n">upper_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.36</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
<span class="n">lower_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">,</span> <span class="mf">0.29</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.36</span><span class="p">,</span> <span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.46</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.57</span><span class="p">,</span> <span class="mf">0.58</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
<span class="n">upper_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.0447</span><span class="p">,</span>  <span class="mf">0.046</span><span class="p">,</span>  <span class="mf">0.0472</span><span class="p">,</span>  <span class="mf">0.0484</span><span class="p">,</span>  <span class="mf">0.0495</span><span class="p">,</span>  <span class="mf">0.0505</span><span class="p">,</span>  <span class="mf">0.0514</span><span class="p">,</span>  <span class="mf">0.0523</span><span class="p">,</span>  <span class="mf">0.0531</span><span class="p">,</span>  <span class="mf">0.0538</span><span class="p">,</span> <span class="mf">0.0545</span><span class="p">,</span>  <span class="mf">0.0551</span><span class="p">,</span>  <span class="mf">0.0557</span><span class="p">,</span> <span class="mf">0.0563</span><span class="p">,</span>  <span class="mf">0.0568</span><span class="p">,</span> <span class="mf">0.0573</span><span class="p">,</span>  <span class="mf">0.0577</span><span class="p">,</span>  <span class="mf">0.0581</span><span class="p">,</span>  <span class="mf">0.0585</span><span class="p">,</span>  <span class="mf">0.0588</span><span class="p">,</span>  <span class="mf">0.0591</span><span class="p">,</span>  <span class="mf">0.0593</span><span class="p">,</span>  <span class="mf">0.0595</span><span class="p">,</span>  <span class="mf">0.0597</span><span class="p">,</span>  <span class="mf">0.0599</span><span class="p">,</span>  <span class="mf">0.06</span><span class="p">,</span>    <span class="mf">0.0601</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0602</span><span class="p">,</span>  <span class="mf">0.0601</span><span class="p">,</span>  <span class="mf">0.06</span><span class="p">,</span>    <span class="mf">0.0599</span><span class="p">,</span>  <span class="mf">0.0598</span><span class="p">,</span>  <span class="mf">0.0596</span><span class="p">,</span>  <span class="mf">0.0594</span><span class="p">,</span>  <span class="mf">0.0592</span><span class="p">,</span>  <span class="mf">0.0589</span><span class="p">,</span>  <span class="mf">0.0586</span><span class="p">,</span>  <span class="mf">0.0583</span><span class="p">,</span>  <span class="mf">0.058</span><span class="p">,</span>   <span class="mf">0.0576</span><span class="p">,</span>  <span class="mf">0.0572</span><span class="p">,</span>  <span class="mf">0.0568</span><span class="p">,</span>  <span class="mf">0.0563</span><span class="p">,</span>  <span class="mf">0.0558</span><span class="p">,</span>  <span class="mf">0.0553</span><span class="p">,</span>  <span class="mf">0.0547</span><span class="p">,</span>  <span class="mf">0.0541</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
<span class="n">lower_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.0447</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.046</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0473</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0485</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0496</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0506</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0515</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0524</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0532</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.054</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0547</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0554</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.056</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0565</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.057</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0575</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0579</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0583</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0586</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0589</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0592</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0594</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0595</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0596</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0598</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0597</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0596</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0594</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0592</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0589</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0586</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0582</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0578</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0573</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0567</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0561</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0554</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0546</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0538</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0529</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0519</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0509</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0497</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0485</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0472</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0458</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0444</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 2</span>

<span class="c1"># Create a dictionary to store options about the surface</span>
<span class="n">mesh_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;num_y&#39;</span> <span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
             <span class="s1">&#39;num_x&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
             <span class="s1">&#39;wing_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;uCRM_based&#39;</span><span class="p">,</span>
             <span class="s1">&#39;symmetry&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
             <span class="s1">&#39;chord_cos_spacing&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="s1">&#39;span_cos_spacing&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
             <span class="s1">&#39;num_twist_cp&#39;</span> <span class="p">:</span> <span class="mi">4</span>
             <span class="p">}</span>

<span class="n">mesh</span><span class="p">,</span> <span class="n">twist_cp</span> <span class="o">=</span> <span class="n">generate_mesh</span><span class="p">(</span><span class="n">mesh_dict</span><span class="p">)</span>

<span class="c1">#docs checkpoint 3</span>

<span class="n">surf_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># Wing definition</span>
            <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;wing&#39;</span><span class="p">,</span>         <span class="c1"># give the surface some name</span>
            <span class="s1">&#39;symmetry&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>       <span class="c1"># if True, model only one half of the lifting surface</span>
            <span class="s1">&#39;S_ref_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;projected&#39;</span><span class="p">,</span> <span class="c1"># how we compute the wing area,</span>
                                     <span class="c1"># can be &#39;wetted&#39; or &#39;projected&#39;</span>
            <span class="s1">&#39;mesh&#39;</span> <span class="p">:</span> <span class="n">mesh</span><span class="p">,</span>

            <span class="s1">&#39;fem_model_type&#39;</span> <span class="p">:</span> <span class="s1">&#39;wingbox&#39;</span><span class="p">,</span> <span class="c1"># &#39;wingbox&#39; or &#39;tube&#39;</span>
            <span class="s1">&#39;data_x_upper&#39;</span> <span class="p">:</span> <span class="n">upper_x</span><span class="p">,</span>
            <span class="s1">&#39;data_x_lower&#39;</span> <span class="p">:</span> <span class="n">lower_x</span><span class="p">,</span>
            <span class="s1">&#39;data_y_upper&#39;</span> <span class="p">:</span> <span class="n">upper_y</span><span class="p">,</span>
            <span class="s1">&#39;data_y_lower&#39;</span> <span class="p">:</span> <span class="n">lower_y</span><span class="p">,</span>

            <span class="c1">#docs checkpoint 4</span>

            <span class="s1">&#39;twist_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">]),</span> <span class="c1"># [deg]</span>

            <span class="s1">&#39;spar_thickness_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]),</span> <span class="c1"># [m]</span>
            <span class="s1">&#39;skin_thickness_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">]),</span> <span class="c1"># [m]</span>

            <span class="s1">&#39;t_over_c_cp&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">]),</span>
            <span class="s1">&#39;original_wingbox_airfoil_t_over_c&#39;</span> <span class="p">:</span> <span class="mf">0.12</span><span class="p">,</span>

            <span class="c1">#docs checkpoint 5</span>

            <span class="c1"># Aerodynamic deltas.</span>
            <span class="c1"># These CL0 and CD0 values are added to the CL and CD</span>
            <span class="c1"># obtained from aerodynamic analysis of the surface to get</span>
            <span class="c1"># the total CL and CD.</span>
            <span class="c1"># These CL0 and CD0 values do not vary wrt alpha.</span>
            <span class="c1"># They can be used to account for things that are not included, such as contributions from the fuselage, camber, etc.</span>
            <span class="s1">&#39;CL0&#39;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>            <span class="c1"># CL delta</span>
            <span class="s1">&#39;CD0&#39;</span> <span class="p">:</span> <span class="mf">0.0078</span><span class="p">,</span>         <span class="c1"># CD delta</span>

            <span class="s1">&#39;with_viscous&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>  <span class="c1"># if true, compute viscous drag</span>
            <span class="s1">&#39;with_wave&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>     <span class="c1"># if true, compute wave drag</span>

            <span class="c1"># Airfoil properties for viscous drag calculation</span>
            <span class="s1">&#39;k_lam&#39;</span> <span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>         <span class="c1"># fraction of chord with laminar</span>
                                    <span class="c1"># flow, used for viscous drag</span>
            <span class="s1">&#39;c_max_t&#39;</span> <span class="p">:</span> <span class="o">.</span><span class="mi">38</span><span class="p">,</span>       <span class="c1"># chordwise location of maximum thickness</span>

            <span class="c1">#docs checkpoint 6</span>

            <span class="c1"># Structural values are based on aluminum 7075</span>
            <span class="s1">&#39;E&#39;</span> <span class="p">:</span> <span class="mf">73.1e9</span><span class="p">,</span>              <span class="c1"># [Pa] Young&#39;s modulus</span>
            <span class="s1">&#39;G&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mf">73.1e9</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mf">1.33</span><span class="p">),</span>     <span class="c1"># [Pa] shear modulus (calculated using E and the Poisson&#39;s ratio here)</span>
            <span class="s1">&#39;yield&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mf">420.e6</span> <span class="o">/</span> <span class="mf">1.5</span><span class="p">),</span>  <span class="c1"># [Pa] allowable yield stress</span>
            <span class="s1">&#39;mrho&#39;</span> <span class="p">:</span> <span class="mf">2.78e3</span><span class="p">,</span>           <span class="c1"># [kg/m^3] material density</span>
            <span class="s1">&#39;strength_factor_for_upper_skin&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="c1"># the yield stress is multiplied by this factor for the upper skin</span>

            <span class="s1">&#39;wing_weight_ratio&#39;</span> <span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span>
            <span class="s1">&#39;exact_failure_constraint&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="c1"># if false, use KS function</span>

            <span class="c1">#docs checkpoint 7</span>

            <span class="s1">&#39;struct_weight_relief&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s1">&#39;distributed_fuel_weight&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>

            <span class="c1">#docs checkpoint 8</span>

            <span class="s1">&#39;fuel_density&#39;</span> <span class="p">:</span> <span class="mf">803.</span><span class="p">,</span>      <span class="c1"># [kg/m^3] fuel density (only needed if the fuel-in-wing volume constraint is used)</span>
            <span class="s1">&#39;Wf_reserve&#39;</span> <span class="p">:</span><span class="mf">15000.</span><span class="p">,</span>       <span class="c1"># [kg] reserve fuel mass</span>

            <span class="p">}</span>

<span class="n">surfaces</span> <span class="o">=</span> <span class="p">[</span><span class="n">surf_dict</span><span class="p">]</span>

<span class="c1">#docs checkpoint 9</span>

<span class="c1"># Create the problem and assign the model group</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">()</span>

<span class="c1"># Add problem information as an independent variables component</span>
<span class="n">indep_var_comp</span> <span class="o">=</span> <span class="n">IndepVarComp</span><span class="p">()</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;Mach_number&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.64</span><span class="p">]))</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">85</span> <span class="o">*</span> <span class="mf">295.07</span><span class="p">,</span> <span class="o">.</span><span class="mi">64</span> <span class="o">*</span> <span class="mf">340.294</span><span class="p">]),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;re&#39;</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.348</span><span class="o">*</span><span class="mf">295.07</span><span class="o">*.</span><span class="mi">85</span><span class="o">*</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.43</span><span class="o">*</span><span class="mf">1e-5</span><span class="p">),</span> \
                          <span class="mf">1.225</span><span class="o">*</span><span class="mf">340.294</span><span class="o">*.</span><span class="mi">64</span><span class="o">*</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.81206</span><span class="o">*</span><span class="mf">1e-5</span><span class="p">)]),</span>  <span class="n">units</span><span class="o">=</span><span class="s1">&#39;1/m&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.348</span><span class="p">,</span> <span class="mf">1.225</span><span class="p">]),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg/m**3&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;speed_of_sound&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">295.07</span><span class="p">,</span> <span class="mf">340.294</span><span class="p">]),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 10</span>

<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;CT&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.53</span><span class="o">/</span><span class="mi">3600</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;1/s&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">14.307e6</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;W0&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mi">148000</span> <span class="o">+</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;Wf_reserve&#39;</span><span class="p">],</span>  <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 11</span>

<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;load_factor&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">]))</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;alpha_maneuver&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>

<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;empty_cg&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">)),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 12</span>

<span class="n">indep_var_comp</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">10000.</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;prob_vars&#39;</span><span class="p">,</span>
     <span class="n">indep_var_comp</span><span class="p">,</span>
     <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>

<span class="c1">#docs checkpoint 13</span>

<span class="c1"># Loop over each surface in the surfaces list</span>
<span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>

    <span class="c1"># Get the surface name and create a group to contain components</span>
    <span class="c1"># only for this surface</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">surface</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

    <span class="n">aerostruct_group</span> <span class="o">=</span> <span class="n">AerostructGeometry</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">)</span>

    <span class="c1"># Add groups to the problem with the name of the surface.</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">aerostruct_group</span><span class="p">)</span>

<span class="c1">#docs checkpoint 14</span>

<span class="c1"># Loop through and add a certain number of aerostruct points</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>

    <span class="n">point_name</span> <span class="o">=</span> <span class="s1">&#39;AS_point_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># Connect the parameters within the model for each aero point</span>

    <span class="c1"># Create the aerostruct point group and add it to the model</span>
    <span class="n">AS_point</span> <span class="o">=</span> <span class="n">AerostructPoint</span><span class="p">(</span><span class="n">surfaces</span><span class="o">=</span><span class="n">surfaces</span><span class="p">,</span> <span class="n">internally_connect_fuelburn</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="n">point_name</span><span class="p">,</span> <span class="n">AS_point</span><span class="p">)</span>

    <span class="c1">#docs checkpoint 15</span>

    <span class="c1"># Connect flow properties to the analysis point</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.v&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;Mach_number&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.Mach_number&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;re&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.re&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.rho&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;CT&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.CT&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.R&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;W0&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.W0&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;speed_of_sound&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.speed_of_sound&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;empty_cg&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.empty_cg&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;load_factor&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.load_factor&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.total_perf.L_equals_W.fuelburn&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.total_perf.CG.fuelburn&#39;</span><span class="p">)</span>

    <span class="c1">#docs checkpoint 16</span>

    <span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">surface</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;distributed_fuel_weight&#39;</span><span class="p">]:</span>
            <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;load_factor&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.load_factor&#39;</span><span class="p">,</span> <span class="n">src_indices</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">com_name</span> <span class="o">=</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_perf.&#39;</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.local_stiff_transformed&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.local_stiff_transformed&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.nodes&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.nodes&#39;</span><span class="p">)</span>

        <span class="c1"># Connect aerodyamic mesh to coupled group mesh</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.mesh&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.mesh&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;struct_weight_relief&#39;</span><span class="p">]:</span>
            <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.element_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.coupled.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.element_mass&#39;</span><span class="p">)</span>

        <span class="c1"># Connect performance calculation variables</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.nodes&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;nodes&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.cg_location&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="s1">&#39;total_perf.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_cg_location&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.structural_mass&#39;</span><span class="p">,</span> <span class="n">point_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="s1">&#39;total_perf.&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_structural_mass&#39;</span><span class="p">)</span>

        <span class="c1"># Connect wingbox properties to von Mises stress calcs</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.Qz&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;Qz&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.J&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;J&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.A_enc&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;A_enc&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.htop&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;htop&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hbottom&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;hbottom&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hfront&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;hfront&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.hrear&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;hrear&#39;</span><span class="p">)</span>

        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.spar_thickness&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;spar_thickness&#39;</span><span class="p">)</span>
        <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.t_over_c&#39;</span><span class="p">,</span> <span class="n">com_name</span> <span class="o">+</span> <span class="s1">&#39;t_over_c&#39;</span><span class="p">)</span>


<span class="c1">#docs checkpoint 17</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0&#39;</span> <span class="o">+</span> <span class="s1">&#39;.alpha&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;alpha_maneuver&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1&#39;</span> <span class="o">+</span> <span class="s1">&#39;.alpha&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 18</span>

<span class="c1"># Here we add the fuel volume constraint componenet to the model</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;fuel_vol_delta&#39;</span><span class="p">,</span> <span class="n">WingboxFuelVolDelta</span><span class="p">(</span><span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">))</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;wing.struct_setup.fuel_vols&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_vol_delta.fuel_vols&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_vol_delta.fuelburn&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;distributed_fuel_weight&#39;</span><span class="p">]:</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;wing.struct_setup.fuel_vols&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0.coupled.wing.struct_states.fuel_vols&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0.coupled.wing.struct_states.fuel_mass&#39;</span><span class="p">)</span>

    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;wing.struct_setup.fuel_vols&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1.coupled.wing.struct_states.fuel_vols&#39;</span><span class="p">)</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1.coupled.wing.struct_states.fuel_mass&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 19</span>

<span class="n">comp</span> <span class="o">=</span> <span class="n">ExecComp</span><span class="p">(</span><span class="s1">&#39;fuel_diff = (fuel_mass - fuelburn) / fuelburn&#39;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_subsystem</span><span class="p">(</span><span class="s1">&#39;fuel_diff&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span>
    <span class="n">promotes_inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">],</span>
    <span class="n">promotes_outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fuel_diff&#39;</span><span class="p">])</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_diff.fuelburn&#39;</span><span class="p">)</span>

<span class="c1">#docs checkpoint 20</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.twist_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mf">15.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">15.</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.spar_thickness_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.skin_thickness_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;wing.geometry.t_over_c_cp&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;alpha_maneuver&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mf">15.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1">#docs checkpoint 21</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;AS_point_0.CL&#39;</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1">#docs checkpoint 22</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;AS_point_1.L_equals_W&#39;</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;AS_point_1.wing_perf.failure&#39;</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

<span class="c1">#docs checkpoint 23</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;fuel_vol_delta.fuel_vol_delta&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

<span class="c1">#docs checkpoint 24</span>

<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_design_var</span><span class="p">(</span><span class="s1">&#39;fuel_mass&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">2e5</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;fuel_diff&#39;</span><span class="p">,</span> <span class="n">equals</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

<span class="c1">#docs checkpoint 25</span>

<span class="n">prob</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">ScipyOptimizeDriver</span><span class="p">()</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;optimizer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SLSQP&#39;</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;tol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-2</span>

<span class="c1">#docs checkpoint 26</span>

<span class="n">recorder</span> <span class="o">=</span> <span class="n">SqliteRecorder</span><span class="p">(</span><span class="s2">&quot;aerostruct.db&quot;</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_recorder</span><span class="p">(</span><span class="n">recorder</span><span class="p">)</span>

<span class="c1"># We could also just use prob.driver.recording_options[&#39;includes&#39;]=[&#39;*&#39;] here, but for large meshes the database file becomes extremely large. So we just select the variables we need.</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;includes&#39;</span><span class="p">]</span> <span class="o">=</span> \
<span class="p">[</span><span class="s1">&#39;prob_vars.alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;prob_vars.rho&#39;</span><span class="p">,</span> <span class="s1">&#39;prob_vars.v&#39;</span><span class="p">,</span> <span class="s1">&#39;prob_vars.cg&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_1.total_perf.CG.cg&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_0.total_perf.CG.cg&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.coupled.wing_loads.loads&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1.coupled.wing_loads.loads&#39;</span><span class="p">,</span> \
<span class="s1">&#39;wing.wingbox_group.skin_thickness_bsp.skin_thickness&#39;</span><span class="p">,</span> \
<span class="s1">&#39;wing.geometry.mesh.rotate.mesh&#39;</span><span class="p">,</span>\
<span class="s1">&#39;wing.wingbox_group.spar_thickness_bsp.spar_thickness&#39;</span><span class="p">,</span> \
<span class="s1">&#39;wing.wingbox_group.spar_thickness_bsp.spar_thickness&#39;</span><span class="p">,</span> \
<span class="s1">&#39;wing.geometry.t_over_c_bsp.t_over_c&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.wing_perf.struct_funcs.vonmises.vonmises&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_1.wing_perf.struct_funcs.vonmises.vonmises&#39;</span><span class="p">,</span> \
<span class="s1">&#39;wing.struct_setup.structural_mass.structural_mass&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.coupled.wing.def_mesh.displacement_transfer.def_mesh&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_1.coupled.wing.def_mesh.displacement_transfer.def_mesh&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.coupled.wing.aero_geom.normals&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_1.coupled.wing.aero_geom.normals&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.coupled.wing.aero_geom.widths&#39;</span><span class="p">,</span>  <span class="s1">&#39;AS_point_1.coupled.wing.aero_geom.widths&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.coupled.aero_states.panel_forces_surf.wing_sec_forces&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_1.coupled.aero_states.panel_forces_surf.wing_sec_forces&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.wing_perf.aero_funcs.coeffs.CL1&#39;</span><span class="p">,</span> <span class="s1">&#39;AS_point_1.wing_perf.aero_funcs.coeffs.CL1&#39;</span><span class="p">,</span> \
<span class="s1">&#39;AS_point_0.coupled.wing.aero_geom.S_ref&#39;</span><span class="p">,</span>
<span class="s1">&#39;AS_point_1.coupled.wing.aero_geom.S_ref&#39;</span><span class="p">,</span>
<span class="s1">&#39;wing.geometry.twist_bsp.twist&#39;</span><span class="p">]</span>

<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_objectives&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_constraints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_desvars&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">prob</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">recording_options</span><span class="p">[</span><span class="s1">&#39;record_inputs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1">#docs checkpoint 27</span>

<span class="c1"># Set up the problem</span>
<span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="c1"># from openmdao.api import view_model</span>
<span class="c1"># view_model(prob)</span>

<span class="c1"># prob.check_partials(form=&#39;central&#39;, compact_print=True)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">run_driver</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 1.41600186e+10 1
NL: NLBGS 1 ; 676083.561 4.77459513e-05
NL: NLBGS 2 ; 136602.797 9.64707751e-06
NL: NLBGS 3 ; 45104.2775 3.18532614e-06
NL: NLBGS 4 ; 10031.0268 7.08404916e-07
NL: NLBGS 5 ; 3087.68815 2.18056785e-07
NL: NLBGS 6 ; 801.560286 5.66072903e-08
NL: NLBGS 7 ; 223.054968 1.57524487e-08
NL: NLBGS 8 ; 65.2592429 4.60869753e-09
NL: NLBGS 9 ; 16.3865594 1.15724137e-09
NL: NLBGS 10 ; 5.12755387 3.6211491e-10
NL: NLBGS 11 ; 1.18479546 8.36718857e-11
NL: NLBGS 12 ; 0.387211472 2.73454069e-11
NL: NLBGS 13 ; 0.0838727114 5.92320629e-12
NL: NLBGS 14 ; 0.0282993418 1.99853846e-12
NL: NLBGS 15 ; 0.00582831058 4.11603313e-13
NL: NLBGS 16 ; 0.0020147955 1.42287631e-13
NL: NLBGS 17 ; 0.000399018881 2.81792624e-14
NL: NLBGS 18 ; 0.000140490041 9.92160002e-15
NL: NLBGS 19 ; 2.70041228e-05 1.90706831e-15
NL: NLBGS 20 ; 9.63814151e-06 6.80658815e-16
NL: NLBGS 21 ; 1.81245049e-06 1.27997747e-16
NL: NLBGS 22 ; 6.53957243e-07 4.61833603e-17
NL: NLBGS 23 ; 1.24002575e-07 8.75723245e-18
NL: NLBGS 24 ; 6.00378932e-08 4.23995863e-18
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 1.41600186e+10 1
NL: NLBGS 1 ; 1843345.01 0.000130179561
NL: NLBGS 2 ; 1012269.12 7.14878385e-05
NL: NLBGS 3 ; 435996.857 3.0790698e-05
NL: NLBGS 4 ; 339428.672 2.39709199e-05
NL: NLBGS 5 ; 175353.512 1.23837063e-05
NL: NLBGS 6 ; 136565.243 9.64442539e-06
NL: NLBGS 7 ; 71384.9387 5.0413026e-06
NL: NLBGS 8 ; 49396.0951 3.48842021e-06
NL: NLBGS 9 ; 25132.7674 1.77491062e-06
NL: NLBGS 10 ; 17659.9874 1.24717261e-06
NL: NLBGS 11 ; 8894.34101 6.28130601e-07
NL: NLBGS 12 ; 6424.07529 4.53677036e-07
NL: NLBGS 13 ; 3226.00201 2.27824701e-07
NL: NLBGS 14 ; 2364.79685 1.67005207e-07
NL: NLBGS 15 ; 1186.85216 8.38171325e-08
NL: NLBGS 16 ; 875.180086 6.18064219e-08
NL: NLBGS 17 ; 439.234519 3.10193461e-08
NL: NLBGS 18 ; 324.499792 2.29166218e-08
NL: NLBGS 19 ; 162.870826 1.15021619e-08
NL: NLBGS 20 ; 120.381535 8.50150964e-09
NL: NLBGS 21 ; 60.4243528 4.26725094e-09
NL: NLBGS 22 ; 44.6636041 3.15420518e-09
NL: NLBGS 23 ; 22.4192012 1.58327484e-09
NL: NLBGS 24 ; 16.5711337 1.17027626e-09
NL: NLBGS 25 ; 8.318147 5.87438987e-10
NL: NLBGS 26 ; 6.1482013 4.34194436e-10
NL: NLBGS 27 ; 3.08621865 2.17953008e-10
NL: NLBGS 28 ; 2.28108617 1.61093444e-10
NL: NLBGS 29 ; 1.14504472 8.08646338e-11
NL: NLBGS 30 ; 0.846319025 5.97682141e-11
NL: NLBGS 31 ; 0.424830704 3.00021288e-11
NL: NLBGS 32 ; 0.313997336 2.21749239e-11
NL: NLBGS 33 ; 0.157618881 1.11312622e-11
NL: NLBGS 34 ; 0.116497763 8.22723231e-12
NL: NLBGS 35 ; 0.0584790194 4.12986881e-12
NL: NLBGS 36 ; 0.0432224238 3.05242704e-12
NL: NLBGS 37 ; 0.0216966015 1.53224385e-12
NL: NLBGS 38 ; 0.0160361684 1.13249628e-12
NL: NLBGS 39 ; 0.00804976519 5.68485494e-13
NL: NLBGS 40 ; 0.0059496582 4.20173049e-13
NL: NLBGS 41 ; 0.00298658378 2.10916656e-13
NL: NLBGS 42 ; 0.00220741323 1.55890559e-13
NL: NLBGS 43 ; 0.00110806693 7.82532112e-14
NL: NLBGS 44 ; 0.000818982386 5.7837663e-14
NL: NLBGS 45 ; 0.000411109997 2.90331537e-14
NL: NLBGS 46 ; 0.000303854105 2.1458595e-14
NL: NLBGS 47 ; 0.000152527888 1.07717293e-14
NL: NLBGS 48 ; 0.00011273463 7.96147468e-15
NL: NLBGS 49 ; 5.65905132e-05 3.99649991e-15
NL: NLBGS 50 ; 4.18274537e-05 2.95391233e-15
NL: NLBGS 51 ; 2.09955025e-05 1.48273128e-15
NL: NLBGS 52 ; 1.55192147e-05 1.0959883e-15
NL: NLBGS 53 ; 7.79111526e-06 5.5021928e-16
NL: NLBGS 54 ; 5.75797556e-06 4.06636157e-16
NL: NLBGS 55 ; 2.89035977e-06 2.04121184e-16
NL: NLBGS 56 ; 2.13641628e-06 1.50876658e-16
NL: NLBGS 57 ; 1.07386803e-06 7.58380376e-17
NL: NLBGS 58 ; 7.94429099e-07 5.61036761e-17
NL: NLBGS 59 ; 4.01223342e-07 2.83349445e-17
NL: NLBGS 60 ; 3.02505888e-07 2.13633821e-17
NL: NLBGS 61 ; 1.56080669e-07 1.10226316e-17
NL: NLBGS 62 ; 1.21549749e-07 8.58401054e-18
NL: NLBGS 63 ; 7.85351472e-08 5.54626016e-18
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 6.42460142e-08 1
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 9.30043331e-08 1
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 11870032.8 1
NL: NLBGS 1 ; 125734.525 0.0105926013
NL: NLBGS 2 ; 56622.779 0.00477022938
NL: NLBGS 3 ; 8687.56754 0.000731890781
NL: NLBGS 4 ; 3509.11685 0.000295628236
NL: NLBGS 5 ; 607.422152 5.11727444e-05
NL: NLBGS 6 ; 221.868224 1.86914585e-05
NL: NLBGS 7 ; 47.2937125 3.98429503e-06
NL: NLBGS 8 ; 15.4808626 1.30419712e-06
NL: NLBGS 9 ; 3.75778051 3.16577097e-07
NL: NLBGS 10 ; 1.13158858 9.53315463e-08
NL: NLBGS 11 ; 0.295858232 2.49248034e-08
NL: NLBGS 12 ; 0.0839486575 7.07231894e-09
NL: NLBGS 13 ; 0.0230140832 1.93883907e-09
NL: NLBGS 14 ; 0.00625790616 5.27202097e-10
NL: NLBGS 15 ; 0.00177156711 1.49247028e-10
NL: NLBGS 16 ; 0.000467230584 3.93621984e-11
NL: NLBGS 17 ; 0.000135243947 1.13937299e-11
NL: NLBGS 18 ; 3.49016918e-05 2.94031976e-12
NL: NLBGS 19 ; 1.02599608e-05 8.64358252e-13
NL: NLBGS 20 ; 2.6072743e-06 2.1965182e-13
NL: NLBGS 21 ; 7.74553015e-07 6.5252812e-14
NL: NLBGS 22 ; 1.9540272e-07 1.64618518e-14
NL: NLBGS 23 ; 5.87432843e-08 4.94887298e-15
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 25079994.1 1
NL: NLBGS 1 ; 669135.357 0.0266800444
NL: NLBGS 2 ; 35992.7371 0.00143511745
NL: NLBGS 3 ; 69272.2028 0.0027620502
NL: NLBGS 4 ; 2654.52108 0.000105842173
NL: NLBGS 5 ; 3005.15849 0.000119822934
NL: NLBGS 6 ; 1378.02985 5.49453818e-05
NL: NLBGS 7 ; 323.534833 1.2900116e-05
NL: NLBGS 8 ; 346.143977 1.38015972e-05
NL: NLBGS 9 ; 101.677 4.05410782e-06
NL: NLBGS 10 ; 108.191435 4.3138541e-06
NL: NLBGS 11 ; 31.7611778 1.26639495e-06
NL: NLBGS 12 ; 33.705349 1.34391375e-06
NL: NLBGS 13 ; 9.89280093 3.9444989e-07
NL: NLBGS 14 ; 10.4887884 4.18213352e-07
NL: NLBGS 15 ; 3.07830855 1.22739604e-07
NL: NLBGS 16 ; 3.26277398 1.30094687e-07
NL: NLBGS 17 ; 0.957544803 3.81796263e-08
NL: NLBGS 18 ; 1.01481774 4.04632366e-08
NL: NLBGS 19 ; 0.297819842 1.18747971e-08
NL: NLBGS 20 ; 0.315620576 1.25845554e-08
NL: NLBGS 21 ; 0.0926249547 3.69318088e-09
NL: NLBGS 22 ; 0.0981595993 3.91386054e-09
NL: NLBGS 23 ; 0.028806748 1.14859469e-09
NL: NLBGS 24 ; 0.0305278434 1.21721892e-09
NL: NLBGS 25 ; 0.00895894861 3.57214941e-10
NL: NLBGS 26 ; 0.00949418542 3.78556126e-10
NL: NLBGS 27 ; 0.00278623824 1.11094055e-10
NL: NLBGS 28 ; 0.00295269421 1.17731057e-10
NL: NLBGS 29 ; 0.00086652058 3.45502705e-11
NL: NLBGS 30 ; 0.000918287708 3.6614351e-11
NL: NLBGS 31 ; 0.00026948872 1.07451668e-11
NL: NLBGS 32 ; 0.000285587615 1.13870687e-11
NL: NLBGS 33 ; 8.38109726e-05 3.3417461e-12
NL: NLBGS 34 ; 8.88182501e-05 3.54139836e-12
NL: NLBGS 35 ; 2.60647352e-05 1.03926401e-12
NL: NLBGS 36 ; 2.76239059e-05 1.10143191e-12
NL: NLBGS 37 ; 8.10655735e-06 3.2322804e-13
NL: NLBGS 38 ; 8.58885677e-06 3.42458484e-13
NL: NLBGS 39 ; 2.52120396e-06 1.00526497e-13
NL: NLBGS 40 ; 2.67249976e-06 1.06559027e-13
NL: NLBGS 41 ; 7.84295155e-07 3.1271744e-14
NL: NLBGS 42 ; 8.31064685e-07 3.31365582e-14
NL: NLBGS 43 ; 2.50583203e-07 9.99135812e-15
NL: NLBGS 44 ; 2.59964334e-07 1.03654065e-14
NL: NLBGS 45 ; 8.6277656e-08 3.44009873e-15
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 713350.183 1
NL: NLBGS 1 ; 27369.6925 0.0383678215
NL: NLBGS 2 ; 11091.5998 0.0155486043
NL: NLBGS 3 ; 1692.58632 0.00237272851
NL: NLBGS 4 ; 840.7337 0.0011785708
NL: NLBGS 5 ; 106.728301 0.000149615579
NL: NLBGS 6 ; 54.4690136 7.63566266e-05
NL: NLBGS 7 ; 6.23587995 8.74168128e-06
NL: NLBGS 8 ; 3.23239771 4.53129162e-06
NL: NLBGS 9 ; 0.347124786 4.86612037e-07
NL: NLBGS 10 ; 0.182190366 2.55401023e-07
NL: NLBGS 11 ; 0.0186082527 2.60857194e-08
NL: NLBGS 12 ; 0.00987120151 1.38378061e-08
NL: NLBGS 13 ; 0.000965151998 1.35298486e-09
NL: NLBGS 14 ; 0.000516481018 7.24021708e-10
NL: NLBGS 15 ; 4.86454875e-05 6.81929978e-11
NL: NLBGS 16 ; 2.62096125e-05 3.67415796e-11
NL: NLBGS 17 ; 2.39426541e-06 3.35636756e-12
NL: NLBGS 18 ; 1.29653557e-06 1.8175303e-12
NL: NLBGS 19 ; 1.16481168e-07 1.632875e-13
NL: NLBGS 20 ; 6.39668487e-08 8.96710343e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 2975311.13 1
NL: NLBGS 1 ; 176477.974 0.0593141241
NL: NLBGS 2 ; 161769.701 0.0543706838
NL: NLBGS 3 ; 26850.0538 0.00902428439
NL: NLBGS 4 ; 38178.0656 0.0128316213
NL: NLBGS 5 ; 8259.86696 0.00277613554
NL: NLBGS 6 ; 9213.49391 0.00309664889
NL: NLBGS 7 ; 2192.70954 0.000736968151
NL: NLBGS 8 ; 2489.8784 0.000836846397
NL: NLBGS 9 ; 569.083102 0.000191268434
NL: NLBGS 10 ; 716.35834 0.000240767539
NL: NLBGS 11 ; 159.056537 5.34587915e-05
NL: NLBGS 12 ; 207.184264 6.96344868e-05
NL: NLBGS 13 ; 45.4682486 1.52818467e-05
NL: NLBGS 14 ; 59.5667841 2.00203547e-05
NL: NLBGS 15 ; 13.0150831 4.37436038e-06
NL: NLBGS 16 ; 17.0363607 5.72590897e-06
NL: NLBGS 17 ; 3.71614587 1.24899404e-06
NL: NLBGS 18 ; 4.85802702 1.6327795e-06
NL: NLBGS 19 ; 1.05899663 3.55928029e-07
NL: NLBGS 20 ; 1.38333289 4.64937223e-07
NL: NLBGS 21 ; 0.301475349 1.01325655e-07
NL: NLBGS 22 ; 0.393662446 1.32309674e-07
NL: NLBGS 23 ; 0.0857840398 2.88319561e-08
NL: NLBGS 24 ; 0.111997773 3.76423736e-08
NL: NLBGS 25 ; 0.0244048103 8.20243975e-09
NL: NLBGS 26 ; 0.031860298 1.0708224e-08
NL: NLBGS 27 ; 0.00694239892 2.33333544e-09
NL: NLBGS 28 ; 0.00906301348 3.04607252e-09
NL: NLBGS 29 ; 0.00197483109 6.63739355e-10
NL: NLBGS 30 ; 0.00257803191 8.66474729e-10
NL: NLBGS 31 ; 0.000561753327 1.88804902e-10
NL: NLBGS 32 ; 0.000733335873 2.46473677e-10
NL: NLBGS 33 ; 0.000159793263 5.37064046e-11
NL: NLBGS 34 ; 0.000208601064 7.01106724e-11
NL: NLBGS 35 ; 4.54536225e-05 1.52769309e-11
NL: NLBGS 36 ; 5.93372391e-05 1.99432048e-11
NL: NLBGS 37 ; 1.29297104e-05 4.34566666e-12
NL: NLBGS 38 ; 1.68790242e-05 5.67302827e-12
NL: NLBGS 39 ; 3.67775771e-06 1.23609181e-12
NL: NLBGS 40 ; 4.80325255e-06 1.61436984e-12
NL: NLBGS 41 ; 1.04722637e-06 3.51972053e-13
NL: NLBGS 42 ; 1.36424644e-06 4.58522278e-13
NL: NLBGS 43 ; 3.00810182e-07 1.01102093e-13
NL: NLBGS 44 ; 3.90334607e-07 1.3119119e-13
NL: NLBGS 45 ; 9.44996212e-08 3.17612569e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 752268.868 1
NL: NLBGS 1 ; 10984.9336 0.0146024036
NL: NLBGS 2 ; 5054.03774 0.00671839279
NL: NLBGS 3 ; 789.729775 0.00104979723
NL: NLBGS 4 ; 345.619673 0.000459436364
NL: NLBGS 5 ; 52.9606838 7.04012701e-05
NL: NLBGS 6 ; 23.3225557 3.10029522e-05
NL: NLBGS 7 ; 3.51900296 4.67785271e-06
NL: NLBGS 8 ; 1.55986454 2.07354659e-06
NL: NLBGS 9 ; 0.231818609 3.08159249e-07
NL: NLBGS 10 ; 0.103371114 1.37412458e-07
NL: NLBGS 11 ; 0.0151489336 2.01376586e-08
NL: NLBGS 12 ; 0.00678848239 9.0240108e-09
NL: NLBGS 13 ; 0.000983113556 1.3068646e-09
NL: NLBGS 14 ; 0.000442235993 5.87869592e-10
NL: NLBGS 15 ; 6.3446782e-05 8.43405659e-11
NL: NLBGS 16 ; 2.86211863e-05 3.80464851e-11
NL: NLBGS 17 ; 4.0774569e-06 5.4202122e-12
NL: NLBGS 18 ; 1.84293737e-06 2.44983867e-12
NL: NLBGS 19 ; 2.61185438e-07 3.47196926e-13
NL: NLBGS 20 ; 1.18592657e-07 1.57646637e-13
NL: NLBGS 21 ; 1.98009888e-08 2.63216911e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 3359161.03 1
NL: NLBGS 1 ; 43136.542 0.012841463
NL: NLBGS 2 ; 29872.2941 0.0088927842
NL: NLBGS 3 ; 7361.73182 0.00219153883
NL: NLBGS 4 ; 8528.22554 0.00253879629
NL: NLBGS 5 ; 2106.7357 0.000627161272
NL: NLBGS 6 ; 2538.85725 0.000755800997
NL: NLBGS 7 ; 625.285207 0.000186143267
NL: NLBGS 8 ; 758.20844 0.000225713633
NL: NLBGS 9 ; 185.912372 5.53448824e-05
NL: NLBGS 10 ; 225.888463 6.72455e-05
NL: NLBGS 11 ; 55.2234891 1.64396671e-05
NL: NLBGS 12 ; 67.0905579 1.99724149e-05
NL: NLBGS 13 ; 16.3767583 4.87525255e-06
NL: NLBGS 14 ; 19.8807794 5.91837642e-06
NL: NLBGS 15 ; 4.8494818 1.44365863e-06
NL: NLBGS 16 ; 5.88330877 1.75142207e-06
NL: NLBGS 17 ; 1.43466732 4.27090964e-07
NL: NLBGS 18 ; 1.73985071 5.17942038e-07
NL: NLBGS 19 ; 0.424214884 1.26285963e-07
NL: NLBGS 20 ; 0.514355164 1.53120127e-07
NL: NLBGS 21 ; 0.125404805 3.73321804e-08
NL: NLBGS 22 ; 0.152038242 4.52607781e-08
NL: NLBGS 23 ; 0.0370676209 1.10347854e-08
NL: NLBGS 24 ; 0.0449382952 1.3377833e-08
NL: NLBGS 25 ; 0.0109560705 3.26154967e-09
NL: NLBGS 26 ; 0.0132821874 3.95401925e-09
NL: NLBGS 27 ; 0.00323821967 9.6399656e-10
NL: NLBGS 28 ; 0.00392571115 1.16865822e-09
NL: NLBGS 29 ; 0.000957094629 2.84920735e-10
NL: NLBGS 30 ; 0.00116028769 3.45409964e-10
NL: NLBGS 31 ; 0.000282879624 8.42113915e-11
NL: NLBGS 32 ; 0.000342935286 1.02089564e-10
NL: NLBGS 33 ; 8.36081575e-05 2.4889595e-11
NL: NLBGS 34 ; 0.00010135813 3.01736444e-11
NL: NLBGS 35 ; 2.47110812e-05 7.35632528e-12
NL: NLBGS 36 ; 2.99570346e-05 8.9180109e-12
NL: NLBGS 37 ; 7.30375258e-06 2.17427879e-12
NL: NLBGS 38 ; 8.85354274e-06 2.63564106e-12
NL: NLBGS 39 ; 2.15885667e-06 6.4267734e-13
NL: NLBGS 40 ; 2.61708197e-06 7.79087977e-13
NL: NLBGS 41 ; 6.38818189e-07 1.90171946e-13
NL: NLBGS 42 ; 7.75209333e-07 2.30774687e-13
NL: NLBGS 43 ; 1.92985627e-07 5.74505436e-14
NL: NLBGS 44 ; 2.34109055e-07 6.96927159e-14
NL: NLBGS 45 ; 7.19864322e-08 2.14298843e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 3139907.25 1
NL: NLBGS 1 ; 89969.4067 0.0286535236
NL: NLBGS 2 ; 35176.6872 0.0112030975
NL: NLBGS 3 ; 5831.77414 0.00185730777
NL: NLBGS 4 ; 1831.62678 0.00058333786
NL: NLBGS 5 ; 297.81814 9.48493429e-05
NL: NLBGS 6 ; 96.5947179 3.07635577e-05
NL: NLBGS 7 ; 14.9446313 4.75957729e-06
NL: NLBGS 8 ; 5.02478318 1.60029669e-06
NL: NLBGS 9 ; 0.730040284 2.32503773e-07
NL: NLBGS 10 ; 0.253482581 8.07293212e-08
NL: NLBGS 11 ; 0.0344976089 1.09868242e-08
NL: NLBGS 12 ; 0.0123098361 3.92044575e-09
NL: NLBGS 13 ; 0.00157428938 5.01380853e-10
NL: NLBGS 14 ; 0.000574647193 1.83014066e-10
NL: NLBGS 15 ; 6.94802008e-05 2.21281061e-11
NL: NLBGS 16 ; 2.5834538e-05 8.2278029e-12
NL: NLBGS 17 ; 2.97536232e-06 9.47595608e-13
NL: NLBGS 18 ; 1.12339173e-06 3.57778633e-13
NL: NLBGS 19 ; 1.28593277e-07 4.09544825e-14
NL: NLBGS 20 ; 6.04815483e-08 1.92622085e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 13428730.2 1
NL: NLBGS 1 ; 303417.549 0.0225946567
NL: NLBGS 2 ; 223738.174 0.0166611564
NL: NLBGS 3 ; 43893.4415 0.00326862189
NL: NLBGS 4 ; 41217.1861 0.00306932863
NL: NLBGS 5 ; 10143.0639 0.000755325617
NL: NLBGS 6 ; 8826.9765 0.000657320265
NL: NLBGS 7 ; 2277.45932 0.000169596029
NL: NLBGS 8 ; 1998.80429 0.000148845368
NL: NLBGS 9 ; 505.937037 3.76757169e-05
NL: NLBGS 10 ; 461.40307 3.43593968e-05
NL: NLBGS 11 ; 114.367116 8.51659946e-06
NL: NLBGS 12 ; 106.059042 7.89792037e-06
NL: NLBGS 13 ; 25.953807 1.93270746e-06
NL: NLBGS 14 ; 24.1808082 1.80067719e-06
NL: NLBGS 15 ; 5.87760451 4.37688778e-07
NL: NLBGS 16 ; 5.47917481 4.08018832e-07
NL: NLBGS 17 ; 1.32749566 9.88548912e-08
NL: NLBGS 18 ; 1.23711021 9.21241391e-08
NL: NLBGS 19 ; 0.299283837 2.22868308e-08
NL: NLBGS 20 ; 0.278817438 2.07627552e-08
NL: NLBGS 21 ; 0.0674083327 5.0197101e-09
NL: NLBGS 22 ; 0.0627868617 4.67556208e-09
NL: NLBGS 23 ; 0.0151754967 1.13007682e-09
NL: NLBGS 24 ; 0.0141337643 1.05250192e-09
NL: NLBGS 25 ; 0.0034157201 2.54359127e-10
NL: NLBGS 26 ; 0.00318111081 2.36888429e-10
NL: NLBGS 27 ; 0.000768746439 5.72463984e-11
NL: NLBGS 28 ; 0.00071593342 5.33135605e-11
NL: NLBGS 29 ; 0.000173008486 1.28834583e-11
NL: NLBGS 30 ; 0.000161121488 1.19982668e-11
NL: NLBGS 31 ; 3.8935222e-05 2.89939714e-12
NL: NLBGS 32 ; 3.62589126e-05 2.70009987e-12
NL: NLBGS 33 ; 8.76337467e-06 6.52584014e-13
NL: NLBGS 34 ; 8.16150037e-06 6.07764118e-13
NL: NLBGS 35 ; 1.97315894e-06 1.46935631e-13
NL: NLBGS 36 ; 1.83825768e-06 1.36889911e-13
NL: NLBGS 37 ; 4.5326289e-07 3.37532204e-14
NL: NLBGS 38 ; 4.27441096e-07 3.18303435e-14
NL: NLBGS 39 ; 1.35638195e-07 1.01005972e-14
NL: NLBGS 40 ; 1.17942583e-07 8.78285443e-15
NL: NLBGS 41 ; 1.03350697e-07 7.69623748e-15
NL: NLBGS 42 ; 1.17425953e-07 8.74438247e-15
NL: NLBGS 43 ; 1.04255803e-07 7.76363823e-15
NL: NLBGS 44 ; 9.36482875e-08 6.97372618e-15
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 2520482.58 1
NL: NLBGS 1 ; 14127.3786 0.00560502924
NL: NLBGS 2 ; 4314.4013 0.00171173621
NL: NLBGS 3 ; 951.818295 0.000377633356
NL: NLBGS 4 ; 231.943995 9.20236454e-05
NL: NLBGS 5 ; 49.7210196 1.97267857e-05
NL: NLBGS 6 ; 12.3197616 4.88785826e-06
NL: NLBGS 7 ; 2.60534252 1.03366813e-06
NL: NLBGS 8 ; 0.651265669 2.58389276e-07
NL: NLBGS 9 ; 0.13657274 5.41851553e-08
NL: NLBGS 10 ; 0.0343485403 1.36277634e-08
NL: NLBGS 11 ; 0.00715746537 2.83972023e-09
NL: NLBGS 12 ; 0.00180874183 7.1761727e-10
NL: NLBGS 13 ; 0.000374983086 1.48774322e-10
NL: NLBGS 14 ; 9.51233314e-05 3.77401265e-11
NL: NLBGS 15 ; 1.96400919e-05 7.79219507e-12
NL: NLBGS 16 ; 4.99648113e-06 1.98235099e-12
NL: NLBGS 17 ; 1.02864623e-06 4.08114793e-13
NL: NLBGS 18 ; 2.63054479e-07 1.04366712e-13
NL: NLBGS 19 ; 5.76845449e-08 2.28863097e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 8607128.58 1
NL: NLBGS 1 ; 59543.8914 0.00691797396
NL: NLBGS 2 ; 55507.2155 0.00644898179
NL: NLBGS 3 ; 4663.62266 0.000541832577
NL: NLBGS 4 ; 6575.48245 0.000763957734
NL: NLBGS 5 ; 511.878824 5.94714972e-05
NL: NLBGS 6 ; 441.878885 5.13387108e-05
NL: NLBGS 7 ; 66.8156337 7.76282509e-06
NL: NLBGS 8 ; 68.8163723 7.99527643e-06
NL: NLBGS 9 ; 10.0771124 1.17078678e-06
NL: NLBGS 10 ; 10.5835143 1.22962196e-06
NL: NLBGS 11 ; 1.52725888 1.77441159e-07
NL: NLBGS 12 ; 1.61760435 1.87937747e-07
NL: NLBGS 13 ; 0.231205002 2.68620365e-08
NL: NLBGS 14 ; 0.245168182 2.84843173e-08
NL: NLBGS 15 ; 0.0348744237 4.05180698e-09
NL: NLBGS 16 ; 0.0369762204 4.29599954e-09
NL: NLBGS 17 ; 0.00524831214 6.09763418e-10
NL: NLBGS 18 ; 0.00556343094 6.46374791e-10
NL: NLBGS 19 ; 0.000788918052 9.16586809e-11
NL: NLBGS 20 ; 0.000836183023 9.71500559e-11
NL: NLBGS 21 ; 0.000118526077 1.37706874e-11
NL: NLBGS 22 ; 0.000125619341 1.45948024e-11
NL: NLBGS 23 ; 1.78038473e-05 2.06850021e-12
NL: NLBGS 24 ; 1.88669171e-05 2.1920106e-12
NL: NLBGS 25 ; 2.67649679e-06 3.10962799e-13
NL: NLBGS 26 ; 2.83458411e-06 3.2932982e-13
NL: NLBGS 27 ; 4.09143158e-07 4.75353835e-14
NL: NLBGS 28 ; 4.35443952e-07 5.05910825e-14
NL: NLBGS 29 ; 1.21941082e-07 1.41674521e-14
NL: NLBGS 30 ; 1.06112022e-07 1.23283881e-14
NL: NLBGS 31 ; 8.90182493e-08 1.03423864e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 1076103.86 1
NL: NLBGS 1 ; 2380.29084 0.0022119527
NL: NLBGS 2 ; 865.506123 0.000804296087
NL: NLBGS 3 ; 145.719238 0.000135413731
NL: NLBGS 4 ; 33.7904397 3.14007235e-05
NL: NLBGS 5 ; 6.5407405 6.07816843e-06
NL: NLBGS 6 ; 1.4355306 1.33400748e-06
NL: NLBGS 7 ; 0.289831085 2.69333747e-07
NL: NLBGS 8 ; 0.0622042526 5.78050641e-08
NL: NLBGS 9 ; 0.0127530036 1.18510899e-08
NL: NLBGS 10 ; 0.00271300341 2.52113529e-09
NL: NLBGS 11 ; 0.000559418835 5.19855803e-10
NL: NLBGS 12 ; 0.000118611108 1.10222733e-10
NL: NLBGS 13 ; 2.45080839e-05 2.27748313e-11
NL: NLBGS 14 ; 5.19162746e-06 4.82446691e-12
NL: NLBGS 15 ; 1.07410226e-06 9.98139955e-13
NL: NLBGS 16 ; 2.29245202e-07 2.13032599e-13
NL: NLBGS 17 ; 5.766435e-08 5.35862311e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 3665646.52 1
NL: NLBGS 1 ; 22187.862 0.00605291914
NL: NLBGS 2 ; 29960.6782 0.00817336805
NL: NLBGS 3 ; 714.221109 0.000194841784
NL: NLBGS 4 ; 1090.60175 0.000297519617
NL: NLBGS 5 ; 122.580712 3.34404071e-05
NL: NLBGS 6 ; 113.10234 3.08546772e-05
NL: NLBGS 7 ; 8.1977967 2.23638495e-06
NL: NLBGS 8 ; 3.23520574 8.82574389e-07
NL: NLBGS 9 ; 1.46177682 3.98777355e-07
NL: NLBGS 10 ; 0.774275589 2.11224837e-07
NL: NLBGS 11 ; 0.349758604 9.54152568e-08
NL: NLBGS 12 ; 0.185174664 5.05162359e-08
NL: NLBGS 13 ; 0.0835975311 2.28056717e-08
NL: NLBGS 14 ; 0.0442615823 1.20747001e-08
NL: NLBGS 15 ; 0.0199749851 5.4492393e-09
NL: NLBGS 16 ; 0.0105767952 2.88538328e-09
NL: NLBGS 17 ; 0.00477242951 1.30193391e-09
NL: NLBGS 18 ; 0.00252712866 6.89408714e-10
NL: NLBGS 19 ; 0.00114019588 3.11049052e-10
NL: NLBGS 20 ; 0.00060377705 1.64712295e-10
NL: NLBGS 21 ; 0.000272403822 7.43126269e-11
NL: NLBGS 22 ; 0.000144251198 3.93521846e-11
NL: NLBGS 23 ; 6.50795644e-05 1.77539116e-11
NL: NLBGS 24 ; 3.44626009e-05 9.40150684e-12
NL: NLBGS 25 ; 1.55494299e-05 4.24193381e-12
NL: NLBGS 26 ; 8.23273535e-06 2.24591632e-12
NL: NLBGS 27 ; 3.71495881e-06 1.01345255e-12
NL: NLBGS 28 ; 1.97058748e-06 5.37582516e-13
NL: NLBGS 29 ; 8.88871399e-07 2.42486937e-13
NL: NLBGS 30 ; 4.79293643e-07 1.30752826e-13
NL: NLBGS 31 ; 2.32896932e-07 6.35350219e-14
NL: NLBGS 32 ; 1.43490939e-07 3.91447832e-14
NL: NLBGS 33 ; 8.46607268e-08 2.30957148e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 543077.906 1
NL: NLBGS 1 ; 1098.51749 0.00202276226
NL: NLBGS 2 ; 392.227553 0.000722230729
NL: NLBGS 3 ; 76.8260038 0.000141464057
NL: NLBGS 4 ; 17.3570834 3.19605773e-05
NL: NLBGS 5 ; 3.79807099 6.99360247e-06
NL: NLBGS 6 ; 0.810479738 1.49238208e-06
NL: NLBGS 7 ; 0.184115061 3.39021454e-07
NL: NLBGS 8 ; 0.0383191567 7.05592259e-08
NL: NLBGS 9 ; 0.00883787949 1.62736863e-08
NL: NLBGS 10 ; 0.00181871101 3.34889523e-09
NL: NLBGS 11 ; 0.000422352509 7.77701512e-10
NL: NLBGS 12 ; 8.64382127e-05 1.59163559e-10
NL: NLBGS 13 ; 2.01429471e-05 3.70903453e-11
NL: NLBGS 14 ; 4.11051246e-06 7.56891859e-12
NL: NLBGS 15 ; 9.60204214e-07 1.76807821e-12
NL: NLBGS 16 ; 1.97659725e-07 3.63962007e-13
NL: NLBGS 17 ; 5.33235125e-08 9.81875931e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 1900366.64 1
NL: NLBGS 1 ; 10402.1837 0.00547377729
NL: NLBGS 2 ; 14609.5848 0.00768777164
NL: NLBGS 3 ; 322.63853 0.000169776991
NL: NLBGS 4 ; 527.725639 0.000277696749
NL: NLBGS 5 ; 42.8815939 2.25649056e-05
NL: NLBGS 6 ; 52.2785125 2.75096981e-05
NL: NLBGS 7 ; 2.63613001 1.38716917e-06
NL: NLBGS 8 ; 3.33014348 1.75236894e-06
NL: NLBGS 9 ; 0.199260594 1.04853763e-07
NL: NLBGS 10 ; 0.252062036 1.32638634e-07
NL: NLBGS 11 ; 0.021246971 1.11804589e-08
NL: NLBGS 12 ; 0.0265149455 1.39525421e-08
NL: NLBGS 13 ; 0.00252257284 1.32741377e-09
NL: NLBGS 14 ; 0.00321925369 1.69401716e-09
NL: NLBGS 15 ; 0.000315684106 1.66117474e-10
NL: NLBGS 16 ; 0.00044290809 2.33064547e-10
NL: NLBGS 17 ; 4.53895583e-05 2.38846322e-11
NL: NLBGS 18 ; 7.7868508e-05 4.09755183e-11
NL: NLBGS 19 ; 9.65389661e-06 5.08001794e-12
NL: NLBGS 20 ; 1.95876756e-05 1.0307314e-11
NL: NLBGS 21 ; 3.12963514e-06 1.6468586e-12
NL: NLBGS 22 ; 6.60414153e-06 3.47519336e-12
NL: NLBGS 23 ; 1.26857354e-06 6.67541472e-13
NL: NLBGS 24 ; 2.67304224e-06 1.40659291e-12
NL: NLBGS 25 ; 5.86700661e-07 3.08730246e-13
NL: NLBGS 26 ; 1.20446526e-06 6.33806782e-13
NL: NLBGS 27 ; 2.92491029e-07 1.53912946e-13
NL: NLBGS 28 ; 5.87859173e-07 3.09339872e-13
NL: NLBGS 29 ; 1.63529859e-07 8.60517417e-14
NL: NLBGS 30 ; 3.18790638e-07 1.67752175e-13
NL: NLBGS 31 ; 1.3564879e-07 7.13803257e-14
NL: NLBGS 32 ; 2.05158051e-07 1.07957089e-13
NL: NLBGS 33 ; 1.43433148e-07 7.54765658e-14
NL: NLBGS 34 ; 1.49535563e-07 7.86877434e-14
NL: NLBGS 35 ; 1.28261896e-07 6.7493237e-14
NL: NLBGS 36 ; 1.11063949e-07 5.84434325e-14
NL: NLBGS 37 ; 1.00547075e-07 5.29093035e-14
NL: NLBGS 38 ; 7.28190623e-08 3.8318428e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 836499.364 1
NL: NLBGS 1 ; 14171.965 0.0169419914
NL: NLBGS 2 ; 4316.88213 0.00516065202
NL: NLBGS 3 ; 714.055468 0.000853623444
NL: NLBGS 4 ; 151.265071 0.000180831065
NL: NLBGS 5 ; 25.4928868 3.04756798e-05
NL: NLBGS 6 ; 5.36034005 6.40806231e-06
NL: NLBGS 7 ; 0.907425285 1.08478897e-06
NL: NLBGS 8 ; 0.190804501 2.280988e-07
NL: NLBGS 9 ; 0.0322327512 3.85329058e-08
NL: NLBGS 10 ; 0.00680012481 8.12926477e-09
NL: NLBGS 11 ; 0.0011432443 1.36670075e-09
NL: NLBGS 12 ; 0.000242267135 2.89620226e-10
NL: NLBGS 13 ; 4.05038788e-05 4.84206929e-11
NL: NLBGS 14 ; 8.62233911e-06 1.03076458e-11
NL: NLBGS 15 ; 1.43430136e-06 1.71464728e-12
NL: NLBGS 16 ; 3.07543689e-07 3.67655616e-13
NL: NLBGS 17 ; 6.35079208e-08 7.59210629e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 2939878.77 1
NL: NLBGS 1 ; 54241.1828 0.0184501427
NL: NLBGS 2 ; 57335.1324 0.0195025498
NL: NLBGS 3 ; 594.611539 0.000202257162
NL: NLBGS 4 ; 694.791195 0.000236333281
NL: NLBGS 5 ; 262.823401 8.9399401e-05
NL: NLBGS 6 ; 42.986589 1.46218917e-05
NL: NLBGS 7 ; 25.4458318 8.65540171e-06
NL: NLBGS 8 ; 6.3919872 2.17423496e-06
NL: NLBGS 9 ; 4.43259783 1.50774851e-06
NL: NLBGS 10 ; 1.06934253 3.63736946e-07
NL: NLBGS 11 ; 0.745580228 2.53609174e-07
NL: NLBGS 12 ; 0.176494886 6.00347497e-08
NL: NLBGS 13 ; 0.123145608 4.18879883e-08
NL: NLBGS 14 ; 0.0289132176 9.83483327e-09
NL: NLBGS 15 ; 0.0201723515 6.86162698e-09
NL: NLBGS 16 ; 0.00472028502 1.60560533e-09
NL: NLBGS 17 ; 0.00329295038 1.12009734e-09
NL: NLBGS 18 ; 0.000769500828 2.61745768e-10
NL: NLBGS 19 ; 0.000536787809 1.82588416e-10
NL: NLBGS 20 ; 0.000125369461 4.26444322e-11
NL: NLBGS 21 ; 8.74515518e-05 2.97466523e-11
NL: NLBGS 22 ; 2.04217766e-05 6.94646893e-12
NL: NLBGS 23 ; 1.42458726e-05 4.8457347e-12
NL: NLBGS 24 ; 3.32872794e-06 1.13226707e-12
NL: NLBGS 25 ; 2.31935998e-06 7.88930482e-13
NL: NLBGS 26 ; 5.48114719e-07 1.86441266e-13
NL: NLBGS 27 ; 3.93668553e-07 1.3390639e-13
NL: NLBGS 28 ; 1.39676762e-07 4.75110619e-14
NL: NLBGS 29 ; 1.00397156e-07 3.41501006e-14
NL: NLBGS 30 ; 1.00795084e-07 3.4285456e-14
NL: NLBGS 31 ; 8.99895248e-08 3.06099441e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 725828.037 1
NL: NLBGS 1 ; 43480.2504 0.0599043412
NL: NLBGS 2 ; 10450.236 0.0143976747
NL: NLBGS 3 ; 1787.18374 0.00246226881
NL: NLBGS 4 ; 250.381745 0.000344960146
NL: NLBGS 5 ; 43.1159357 5.94024115e-05
NL: NLBGS 6 ; 6.03868053 8.31971241e-06
NL: NLBGS 7 ; 1.03387411 1.42440641e-06
NL: NLBGS 8 ; 0.146446147 2.01764247e-07
NL: NLBGS 9 ; 0.0247615536 3.41149037e-08
NL: NLBGS 10 ; 0.00356561244 4.91247548e-09
NL: NLBGS 11 ; 0.000593768065 8.18056116e-10
NL: NLBGS 12 ; 8.70226219e-05 1.19894269e-10
NL: NLBGS 13 ; 1.42682623e-05 1.96579101e-11
NL: NLBGS 14 ; 2.12777599e-06 2.93151528e-12
NL: NLBGS 15 ; 3.44530999e-07 4.74673037e-13
NL: NLBGS 16 ; 6.7306176e-08 9.27301958e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 2425710.16 1
NL: NLBGS 1 ; 131475.512 0.0542008333
NL: NLBGS 2 ; 103025.503 0.0424723056
NL: NLBGS 3 ; 4948.13566 0.00203987094
NL: NLBGS 4 ; 4006.12692 0.00165152745
NL: NLBGS 5 ; 495.68486 0.000204346285
NL: NLBGS 6 ; 183.497597 7.56469592e-05
NL: NLBGS 7 ; 75.1882938 3.09964047e-05
NL: NLBGS 8 ; 25.5323556 1.0525724e-05
NL: NLBGS 9 ; 10.2379211 4.22058715e-06
NL: NLBGS 10 ; 3.5436116 1.46085532e-06
NL: NLBGS 11 ; 1.40518646 5.79288692e-07
NL: NLBGS 12 ; 0.490777794 2.02323345e-07
NL: NLBGS 13 ; 0.19351296 7.97757964e-08
NL: NLBGS 14 ; 0.0678953751 2.7989896e-08
NL: NLBGS 15 ; 0.0266927752 1.10041074e-08
NL: NLBGS 16 ; 0.00938758494 3.87003571e-09
NL: NLBGS 17 ; 0.00368503938 1.51915899e-09
NL: NLBGS 18 ; 0.00129761632 5.34942857e-10
NL: NLBGS 19 ; 0.000508959421 2.09818729e-10
NL: NLBGS 20 ; 0.000179340735 7.39332911e-11
NL: NLBGS 21 ; 7.03127741e-05 2.89864697e-11
NL: NLBGS 22 ; 2.47865032e-05 1.0218246e-11
NL: NLBGS 23 ; 9.71625169e-06 4.00552871e-12
NL: NLBGS 24 ; 3.42782679e-06 1.41312299e-12
NL: NLBGS 25 ; 1.34720995e-06 5.55387849e-13
NL: NLBGS 26 ; 4.8248605e-07 1.98905071e-13
NL: NLBGS 27 ; 2.15378716e-07 8.87899633e-14
NL: NLBGS 28 ; 1.29010149e-07 5.31844864e-14
NL: NLBGS 29 ; 1.18389879e-07 4.88062758e-14
NL: NLBGS 30 ; 1.04191051e-07 4.2952803e-14
NL: NLBGS 31 ; 1.07079957e-07 4.4143756e-14
NL: NLBGS 32 ; 1.00758961e-07 4.15379228e-14
NL: NLBGS 33 ; 9.15662907e-08 3.77482406e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 526400.145 1
NL: NLBGS 1 ; 33084.4385 0.0628503598
NL: NLBGS 2 ; 9400.52592 0.017858137
NL: NLBGS 3 ; 1606.21904 0.00305132713
NL: NLBGS 4 ; 300.475227 0.000570811444
NL: NLBGS 5 ; 52.7839101 0.000100273358
NL: NLBGS 6 ; 9.62110873 1.82771772e-05
NL: NLBGS 7 ; 1.73725763 3.30026055e-06
NL: NLBGS 8 ; 0.30847792 5.86014124e-07
NL: NLBGS 9 ; 0.0571342004 1.08537585e-07
NL: NLBGS 10 ; 0.00989787977 1.88029579e-08
NL: NLBGS 11 ; 0.00187422269 3.56045246e-09
NL: NLBGS 12 ; 0.000317609303 6.03360971e-10
NL: NLBGS 13 ; 6.12649563e-05 1.16384763e-10
NL: NLBGS 14 ; 1.01874162e-05 1.93529891e-11
NL: NLBGS 15 ; 1.9949387e-06 3.78977611e-12
NL: NLBGS 16 ; 3.27936249e-07 6.22979024e-13
NL: NLBGS 17 ; 7.29723351e-08 1.38625219e-13
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 1732398.2 1
NL: NLBGS 1 ; 103357.327 0.0596614144
NL: NLBGS 2 ; 96525.5019 0.0557178492
NL: NLBGS 3 ; 2927.46673 0.00168983478
NL: NLBGS 4 ; 2646.02498 0.00152737689
NL: NLBGS 5 ; 675.687668 0.000390030229
NL: NLBGS 6 ; 115.01609 6.63912547e-05
NL: NLBGS 7 ; 102.832262 5.9358329e-05
NL: NLBGS 8 ; 8.83878912 5.10205396e-06
NL: NLBGS 9 ; 7.64965776 4.41564632e-06
NL: NLBGS 10 ; 0.671579042 3.87658588e-07
NL: NLBGS 11 ; 0.585930853 3.38219499e-07
NL: NLBGS 12 ; 0.0510515036 2.94686888e-08
NL: NLBGS 13 ; 0.0445227259 2.57000531e-08
NL: NLBGS 14 ; 0.00386791274 2.23269265e-09
NL: NLBGS 15 ; 0.00337556634 1.94849333e-09
NL: NLBGS 16 ; 0.000292360505 1.68760568e-10
NL: NLBGS 17 ; 0.000255195476 1.47307632e-10
NL: NLBGS 18 ; 2.20579929e-05 1.27326343e-11
NL: NLBGS 19 ; 1.92559101e-05 1.11151755e-11
NL: NLBGS 20 ; 1.66544077e-06 9.61349862e-13
NL: NLBGS 21 ; 1.46024878e-06 8.42905966e-13
NL: NLBGS 22 ; 1.67773983e-07 9.684493e-14
NL: NLBGS 23 ; 1.46934021e-07 8.48153851e-14
NL: NLBGS 24 ; 9.76626304e-08 5.6374239e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 717364.327 1
NL: NLBGS 1 ; 43107.8428 0.0600919799
NL: NLBGS 2 ; 10369.4185 0.0144548846
NL: NLBGS 3 ; 1741.78491 0.00242803391
NL: NLBGS 4 ; 239.959151 0.000334501091
NL: NLBGS 5 ; 40.7196273 5.67628271e-05
NL: NLBGS 6 ; 5.59246278 7.79584734e-06
NL: NLBGS 7 ; 0.944923963 1.31721627e-06
NL: NLBGS 8 ; 0.131093765 1.82743635e-07
NL: NLBGS 9 ; 0.0218891625 3.05133134e-08
NL: NLBGS 10 ; 0.00308596929 4.30181593e-09
NL: NLBGS 11 ; 0.000507599553 7.07589622e-10
NL: NLBGS 12 ; 7.28354161e-05 1.01531974e-10
NL: NLBGS 13 ; 1.17938642e-05 1.64405501e-11
NL: NLBGS 14 ; 1.72149733e-06 2.39975318e-12
NL: NLBGS 15 ; 2.78275185e-07 3.87913329e-13
NL: NLBGS 16 ; 6.38047703e-08 8.89433275e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 2380995.47 1
NL: NLBGS 1 ; 127534.394 0.0535634763
NL: NLBGS 2 ; 99417.7243 0.0417546886
NL: NLBGS 3 ; 4504.10027 0.00189168788
NL: NLBGS 4 ; 3576.16558 0.00150196236
NL: NLBGS 5 ; 440.754898 0.000185113707
NL: NLBGS 6 ; 157.006472 6.5941525e-05
NL: NLBGS 7 ; 65.8427915 2.7653472e-05
NL: NLBGS 8 ; 20.8994484 8.7776095e-06
NL: NLBGS 9 ; 8.59762313 3.61093637e-06
NL: NLBGS 10 ; 2.78377127 1.16916278e-06
NL: NLBGS 11 ; 1.13382208 4.76196658e-07
NL: NLBGS 12 ; 0.370503917 1.55608829e-07
NL: NLBGS 13 ; 0.150139714 6.30575388e-08
NL: NLBGS 14 ; 0.0492887931 2.07009185e-08
NL: NLBGS 15 ; 0.019920812 8.36658966e-09
NL: NLBGS 16 ; 0.00655547732 2.75325065e-09
NL: NLBGS 17 ; 0.00264582326 1.11122566e-09
NL: NLBGS 18 ; 0.000871793769 3.66146757e-10
NL: NLBGS 19 ; 0.000351599068 1.47668936e-10
NL: NLBGS 20 ; 0.000115929099 4.86893404e-11
NL: NLBGS 21 ; 4.6738133e-05 1.96296607e-11
NL: NLBGS 22 ; 1.54176721e-05 6.4753051e-12
NL: NLBGS 23 ; 6.21456844e-06 2.61007151e-12
NL: NLBGS 24 ; 2.05513896e-06 8.63142745e-13
NL: NLBGS 25 ; 8.40003072e-07 3.52794906e-13
NL: NLBGS 26 ; 3.32324567e-07 1.39573792e-13
NL: NLBGS 27 ; 2.45627711e-07 1.03161772e-13
NL: NLBGS 28 ; 1.51311244e-07 6.35495726e-14
NL: NLBGS 29 ; 1.69263605e-07 7.10894277e-14
NL: NLBGS 30 ; 1.70435506e-07 7.15816173e-14
NL: NLBGS 31 ; 1.67087021e-07 7.0175279e-14
NL: NLBGS 32 ; 1.8610268e-07 7.81617113e-14
NL: NLBGS 33 ; 1.63834532e-07 6.88092582e-14
NL: NLBGS 34 ; 1.46935565e-07 6.17118205e-14
NL: NLBGS 35 ; 1.50171236e-07 6.30707777e-14
NL: NLBGS 36 ; 1.57787011e-07 6.62693456e-14
NL: NLBGS 37 ; 1.90641756e-07 8.00680885e-14
NL: NLBGS 38 ; 1.2699953e-07 5.33388373e-14
NL: NLBGS 39 ; 1.78992455e-07 7.51754706e-14
NL: NLBGS 40 ; 1.42534074e-07 5.98632279e-14
NL: NLBGS 41 ; 1.7573683e-07 7.3808133e-14
NL: NLBGS 42 ; 1.95678853e-07 8.2183631e-14
NL: NLBGS 43 ; 1.86926416e-07 7.85076741e-14
NL: NLBGS 44 ; 1.95087662e-07 8.19353352e-14
NL: NLBGS 45 ; 1.44335194e-07 6.06196846e-14
NL: NLBGS 46 ; 1.60564505e-07 6.74358716e-14
NL: NLBGS 47 ; 1.90863621e-07 8.01612702e-14
NL: NLBGS 48 ; 2.04516618e-07 8.58954252e-14
NL: NLBGS 49 ; 2.14397977e-07 9.00455209e-14
NL: NLBGS 50 ; 1.95554498e-07 8.21314029e-14
NL: NLBGS 51 ; 1.9467029e-07 8.17600421e-14
NL: NLBGS 52 ; 1.87205498e-07 7.86248863e-14
NL: NLBGS 53 ; 1.67278866e-07 7.02558522e-14
NL: NLBGS 54 ; 2.28005948e-07 9.57607652e-14
NL: NLBGS 55 ; 1.70567881e-07 7.16372135e-14
NL: NLBGS 56 ; 2.06397629e-07 8.66854357e-14
NL: NLBGS 57 ; 1.69145981e-07 7.10400265e-14
NL: NLBGS 58 ; 2.17738232e-07 9.14484025e-14
NL: NLBGS 59 ; 2.25162723e-07 9.45666324e-14
NL: NLBGS 60 ; 2.33024849e-07 9.78686656e-14
NL: NLBGS 61 ; 2.06100709e-07 8.65607313e-14
NL: NLBGS 62 ; 2.45812998e-07 1.03239591e-13
NL: NLBGS 63 ; 2.32382266e-07 9.75987855e-14
NL: NLBGS 64 ; 1.94337864e-07 8.16204258e-14
NL: NLBGS 65 ; 2.14742279e-07 9.0190125e-14
NL: NLBGS 66 ; 2.00418159e-07 8.41741034e-14
NL: NLBGS 67 ; 1.42316528e-07 5.97718601e-14
NL: NLBGS 68 ; 1.61504729e-07 6.78307589e-14
NL: NLBGS 69 ; 1.9598154e-07 8.23107573e-14
NL: NLBGS 70 ; 2.50481584e-07 1.05200362e-13
NL: NLBGS 71 ; 2.17028478e-07 9.11503112e-14
NL: NLBGS 72 ; 2.18265532e-07 9.16698645e-14
NL: NLBGS 73 ; 1.85065056e-07 7.77259171e-14
NL: NLBGS 74 ; 1.83504776e-07 7.70706111e-14
NL: NLBGS 75 ; 1.95480174e-07 8.21001874e-14
NL: NLBGS 76 ; 1.8213553e-07 7.64955382e-14
NL: NLBGS 77 ; 1.9540637e-07 8.20691903e-14
NL: NLBGS 78 ; 1.7485267e-07 7.34367926e-14
NL: NLBGS 79 ; 1.95056798e-07 8.19223725e-14
NL: NLBGS 80 ; 1.93367108e-07 8.12127156e-14
NL: NLBGS 81 ; 2.22471903e-07 9.34365083e-14
NL: NLBGS 82 ; 1.72289589e-07 7.23603181e-14
NL: NLBGS 83 ; 2.36127628e-07 9.91718093e-14
NL: NLBGS 84 ; 2.32850687e-07 9.77955188e-14
NL: NLBGS 85 ; 1.78356169e-07 7.49082354e-14
NL: NLBGS 86 ; 1.76712418e-07 7.42178725e-14
NL: NLBGS 87 ; 1.92888912e-07 8.1011877e-14
NL: NLBGS 88 ; 1.70366996e-07 7.15528434e-14
NL: NLBGS 89 ; 1.87105423e-07 7.85828555e-14
NL: NLBGS 90 ; 1.70800199e-07 7.17347853e-14
NL: NLBGS 91 ; 1.87326943e-07 7.86758925e-14
NL: NLBGS 92 ; 1.70991957e-07 7.18153224e-14
NL: NLBGS 93 ; 1.87390338e-07 7.87025178e-14
NL: NLBGS 94 ; 1.71117435e-07 7.1868022e-14
NL: NLBGS 95 ; 1.87378071e-07 7.86973657e-14
NL: NLBGS 96 ; 1.71138436e-07 7.18768426e-14
NL: NLBGS 97 ; 1.87379075e-07 7.86977875e-14
NL: NLBGS 98 ; 1.71138053e-07 7.18766817e-14
NL: NLBGS 99 ; 1.87379315e-07 7.86978881e-14
NL: NLBGS 100 ; 1.71138179e-07 7.18767347e-14
NL: NLBGS Failed to Converge in 100 iterations

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 638305.807 1
NL: NLBGS 1 ; 39038.8221 0.061160061
NL: NLBGS 2 ; 11052.3028 0.0173150592
NL: NLBGS 3 ; 1853.9705 0.00290451768
NL: NLBGS 4 ; 339.485067 0.000531853328
NL: NLBGS 5 ; 58.9402446 9.23385687e-05
NL: NLBGS 6 ; 10.4579526 1.63839221e-05
NL: NLBGS 7 ; 1.87607086 2.93914114e-06
NL: NLBGS 8 ; 0.322612407 5.05419822e-07
NL: NLBGS 9 ; 0.0596241036 9.34099344e-08
NL: NLBGS 10 ; 0.00995408795 1.55945439e-08
NL: NLBGS 11 ; 0.00188781261 2.95753633e-09
NL: NLBGS 12 ; 0.000306880752 4.80773868e-10
NL: NLBGS 13 ; 5.94718206e-05 9.31713607e-11
NL: NLBGS 14 ; 9.44663064e-06 1.47995374e-11
NL: NLBGS 15 ; 1.86389055e-06 2.9200589e-12
NL: NLBGS 16 ; 2.91283916e-07 4.56339129e-13
NL: NLBGS 17 ; 7.41240647e-08 1.16126258e-13
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 2084364.42 1
NL: NLBGS 1 ; 119271.411 0.057221957
NL: NLBGS 2 ; 110205.815 0.0528726233
NL: NLBGS 3 ; 3280.06149 0.00157365068
NL: NLBGS 4 ; 2896.62276 0.00138969113
NL: NLBGS 5 ; 828.419697 0.00039744475
NL: NLBGS 6 ; 133.813195 6.41985604e-05
NL: NLBGS 7 ; 119.186688 5.71813101e-05
NL: NLBGS 8 ; 9.30776612 4.46551765e-06
NL: NLBGS 9 ; 7.95606264 3.81702093e-06
NL: NLBGS 10 ; 0.648432568 3.11093665e-07
NL: NLBGS 11 ; 0.560705091 2.69005307e-07
NL: NLBGS 12 ; 0.0453002672 2.17333719e-08
NL: NLBGS 13 ; 0.0391107838 1.87638895e-08
NL: NLBGS 14 ; 0.00315729303 1.51475097e-09
NL: NLBGS 15 ; 0.00272888622 1.30921743e-09
NL: NLBGS 16 ; 0.000219576372 1.05344521e-10
NL: NLBGS 17 ; 0.00018981082 9.10641239e-11
NL: NLBGS 18 ; 1.52411787e-05 7.31214682e-12
NL: NLBGS 19 ; 1.31782945e-05 6.32245225e-12
NL: NLBGS 20 ; 1.05894746e-06 5.0804334e-13
NL: NLBGS 21 ; 9.18088548e-07 4.40464507e-13
NL: NLBGS 22 ; 1.38895115e-07 6.66366752e-14
NL: NLBGS 23 ; 9.86595325e-08 4.73331493e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 931087.336 1
NL: NLBGS 1 ; 56324.3783 0.0604931204
NL: NLBGS 2 ; 13295.5333 0.014279577
NL: NLBGS 3 ; 2176.73853 0.00233784571
NL: NLBGS 4 ; 285.597497 0.000306735454
NL: NLBGS 5 ; 47.2231632 5.07182961e-05
NL: NLBGS 6 ; 6.19263701 6.6509733e-06
NL: NLBGS 7 ; 1.01565281 1.09082443e-06
NL: NLBGS 8 ; 0.13535596 1.45374074e-07
NL: NLBGS 9 ; 0.0218160895 2.3430766e-08
NL: NLBGS 10 ; 0.00297582539 3.19607547e-09
NL: NLBGS 11 ; 0.00046954638 5.04298965e-10
NL: NLBGS 12 ; 6.56479098e-05 7.05067154e-11
NL: NLBGS 13 ; 1.01343382e-05 1.0884412e-11
NL: NLBGS 14 ; 1.45135167e-06 1.55877071e-12
NL: NLBGS 15 ; 2.2061404e-07 2.3694237e-13
NL: NLBGS 16 ; 5.49543412e-08 5.90216826e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 3083050.81 1
NL: NLBGS 1 ; 163111.877 0.0529059971
NL: NLBGS 2 ; 122772.286 0.0398216874
NL: NLBGS 3 ; 5929.35841 0.00192321138
NL: NLBGS 4 ; 4514.14247 0.00146418037
NL: NLBGS 5 ; 601.180803 0.000194995425
NL: NLBGS 6 ; 199.799634 6.48058194e-05
NL: NLBGS 7 ; 87.3459501 2.83310122e-05
NL: NLBGS 8 ; 24.0537802 7.80194091e-06
NL: NLBGS 9 ; 10.317993 3.34668276e-06
NL: NLBGS 10 ; 2.91562158 9.45693654e-07
NL: NLBGS 11 ; 1.23785264 4.01502511e-07
NL: NLBGS 12 ; 0.353965975 1.14810296e-07
NL: NLBGS 13 ; 0.149475853 4.84830977e-08
NL: NLBGS 14 ; 0.0430002508 1.39473053e-08
NL: NLBGS 15 ; 0.0181072461 5.87315852e-09
NL: NLBGS 16 ; 0.0052255073 1.69491443e-09
NL: NLBGS 17 ; 0.00219710647 7.12640372e-10
NL: NLBGS 18 ; 0.000635144333 2.06011634e-10
NL: NLBGS 19 ; 0.000266831199 8.65477788e-11
NL: NLBGS 20 ; 7.72096133e-05 2.50432504e-11
NL: NLBGS 21 ; 3.24216118e-05 1.05160809e-11
NL: NLBGS 22 ; 9.38766017e-06 3.04492555e-12
NL: NLBGS 23 ; 3.94226425e-06 1.27868936e-12
NL: NLBGS 24 ; 1.14608754e-06 3.71738128e-13
NL: NLBGS 25 ; 4.95382496e-07 1.60679316e-13
NL: NLBGS 26 ; 1.86623463e-07 6.0532075e-14
NL: NLBGS 27 ; 1.44651459e-07 4.6918286e-14
NL: NLBGS 28 ; 1.19252516e-07 3.86800359e-14
NL: NLBGS 29 ; 1.23774042e-07 4.01466113e-14
NL: NLBGS 30 ; 1.52777856e-07 4.95541156e-14
NL: NLBGS 31 ; 1.78105577e-07 5.77692644e-14
NL: NLBGS 32 ; 1.41245779e-07 4.58136398e-14
NL: NLBGS 33 ; 1.35690426e-07 4.40117387e-14
NL: NLBGS 34 ; 9.84758899e-08 3.19410532e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 866631.639 1
NL: NLBGS 1 ; 51564.95 0.0595004241
NL: NLBGS 2 ; 14579.0804 0.0168226957
NL: NLBGS 3 ; 2378.49538 0.00274452867
NL: NLBGS 4 ; 428.728224 0.000494706407
NL: NLBGS 5 ; 73.0855666 8.43329085e-05
NL: NLBGS 6 ; 12.6585444 1.46066031e-05
NL: NLBGS 7 ; 2.2502903 2.59659376e-06
NL: NLBGS 8 ; 0.374290226 4.31890793e-07
NL: NLBGS 9 ; 0.0691274732 7.9765693e-08
NL: NLBGS 10 ; 0.0110583934 1.27602005e-08
NL: NLBGS 11 ; 0.00211109093 2.4359726e-09
NL: NLBGS 12 ; 0.000325868525 3.76017342e-10
NL: NLBGS 13 ; 6.39575503e-05 7.38001562e-11
NL: NLBGS 14 ; 9.56641042e-06 1.1038612e-11
NL: NLBGS 15 ; 1.92078812e-06 2.21638357e-12
NL: NLBGS 16 ; 2.81109084e-07 3.24369746e-13
NL: NLBGS 17 ; 6.08053061e-08 7.01628043e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 2801616.77 1
NL: NLBGS 1 ; 154850.332 0.0552717751
NL: NLBGS 2 ; 140883.762 0.0502865931
NL: NLBGS 3 ; 4425.25507 0.00157953619
NL: NLBGS 4 ; 3827.71092 0.00136625072
NL: NLBGS 5 ; 1262.45724 0.000450617391
NL: NLBGS 6 ; 200.649497 7.16191807e-05
NL: NLBGS 7 ; 173.462267 6.1915059e-05
NL: NLBGS 8 ; 14.3555477 5.12402261e-06
NL: NLBGS 9 ; 11.8535596 4.23097111e-06
NL: NLBGS 10 ; 1.02965312 3.67521045e-07
NL: NLBGS 11 ; 0.858651377 3.06484237e-07
NL: NLBGS 12 ; 0.0744461421 2.65725644e-08
NL: NLBGS 13 ; 0.0620270102 2.21397198e-08
NL: NLBGS 14 ; 0.00538165098 1.92090904e-09
NL: NLBGS 15 ; 0.00448736981 1.60170722e-09
NL: NLBGS 16 ; 0.000388686261 1.38736413e-10
NL: NLBGS 17 ; 0.000324157088 1.15703579e-10
NL: NLBGS 18 ; 2.80395431e-05 1.00083435e-11
NL: NLBGS 19 ; 2.33890541e-05 8.3484131e-12
NL: NLBGS 20 ; 2.02354593e-06 7.22277922e-13
NL: NLBGS 21 ; 1.68798665e-06 6.02504478e-13
NL: NLBGS 22 ; 1.74664682e-07 6.23442448e-14
NL: NLBGS 23 ; 1.50143605e-07 5.35917712e-14
NL: NLBGS 24 ; 8.52043626e-08 3.04125688e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 874802.276 1
NL: NLBGS 1 ; 55975.2134 0.0639861314
NL: NLBGS 2 ; 13382.9407 0.0152982463
NL: NLBGS 3 ; 2139.48885 0.00244568277
NL: NLBGS 4 ; 282.321027 0.000322725528
NL: NLBGS 5 ; 45.7898522 5.23430877e-05
NL: NLBGS 6 ; 6.02009909 6.88166829e-06
NL: NLBGS 7 ; 0.969845437 1.10864531e-06
NL: NLBGS 8 ; 0.129443644 1.4796903e-07
NL: NLBGS 9 ; 0.020496349 2.34296933e-08
NL: NLBGS 10 ; 0.00279942939 3.20007099e-09
NL: NLBGS 11 ; 0.000433780435 4.95861118e-10
NL: NLBGS 12 ; 6.07372321e-05 6.94296686e-11
NL: NLBGS 13 ; 9.20185553e-06 1.05187833e-11
NL: NLBGS 14 ; 1.32053561e-06 1.50952466e-12
NL: NLBGS 15 ; 2.07435884e-07 2.37123165e-13
NL: NLBGS 16 ; 5.23227992e-08 5.98110003e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 2879367.52 1
NL: NLBGS 1 ; 161145.84 0.0559657073
NL: NLBGS 2 ; 123243.576 0.0428023081
NL: NLBGS 3 ; 5044.82094 0.00175205871
NL: NLBGS 4 ; 3795.60317 0.00131820726
NL: NLBGS 5 ; 576.571381 0.000200242371
NL: NLBGS 6 ; 169.162924 5.87500283e-05
NL: NLBGS 7 ; 83.3300825 2.8940412e-05
NL: NLBGS 8 ; 18.1378048 6.29923227e-06
NL: NLBGS 9 ; 8.86666535 3.07937951e-06
NL: NLBGS 10 ; 1.98183953 6.88289882e-07
NL: NLBGS 11 ; 0.963229879 3.34528285e-07
NL: NLBGS 12 ; 0.217799294 7.56413664e-08
NL: NLBGS 13 ; 0.10552453 3.66485103e-08
NL: NLBGS 14 ; 0.0239973543 8.33424497e-09
NL: NLBGS 15 ; 0.0116071507 4.03114595e-09
NL: NLBGS 16 ; 0.00264754008 9.19486679e-10
NL: NLBGS 17 ; 0.0012793895 4.44330045e-10
NL: NLBGS 18 ; 0.000292300456 1.01515508e-10
NL: NLBGS 19 ; 0.000141178587 4.90311104e-11
NL: NLBGS 20 ; 3.22837094e-05 1.12120836e-11
NL: NLBGS 21 ; 1.55881239e-05 5.41373194e-12
NL: NLBGS 22 ; 3.56900185e-06 1.23950896e-12
NL: NLBGS 23 ; 1.7284536e-06 6.00289329e-13
NL: NLBGS 24 ; 4.19295197e-07 1.4562059e-13
NL: NLBGS 25 ; 2.42509526e-07 8.42231929e-14
NL: NLBGS 26 ; 1.33259381e-07 4.62807823e-14
NL: NLBGS 27 ; 1.08824456e-07 3.77945694e-14
NL: NLBGS 28 ; 1.14040979e-07 3.96062601e-14
NL: NLBGS 29 ; 1.39219691e-07 4.83507889e-14
NL: NLBGS 30 ; 1.50773996e-07 5.23635815e-14
NL: NLBGS 31 ; 1.14278617e-07 3.96887913e-14
NL: NLBGS 32 ; 1.20076094e-07 4.17022464e-14
NL: NLBGS 33 ; 1.42069333e-07 4.9340465e-14
NL: NLBGS 34 ; 1.57019624e-07 5.45326785e-14
NL: NLBGS 35 ; 1.14617762e-07 3.9806576e-14
NL: NLBGS 36 ; 1.31168467e-07 4.55546109e-14
NL: NLBGS 37 ; 1.00566666e-07 3.49266515e-14
NL: NLBGS 38 ; 1.09717603e-07 3.81047581e-14
NL: NLBGS 39 ; 1.10828055e-07 3.84904164e-14
NL: NLBGS 40 ; 1.08723674e-07 3.77595681e-14
NL: NLBGS 41 ; 9.94608985e-08 3.45426201e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 821000.685 1
NL: NLBGS 1 ; 51215.5898 0.0623819087
NL: NLBGS 2 ; 14464.3166 0.0176179105
NL: NLBGS 3 ; 2300.98943 0.00280266444
NL: NLBGS 4 ; 408.392108 0.000497432115
NL: NLBGS 5 ; 68.3054278 8.31977719e-05
NL: NLBGS 6 ; 11.6072744 1.41379595e-05
NL: NLBGS 7 ; 2.03008232 2.47269261e-06
NL: NLBGS 8 ; 0.330595033 4.02673273e-07
NL: NLBGS 9 ; 0.0601600538 7.32764965e-08
NL: NLBGS 10 ; 0.00940829313 1.14595436e-08
NL: NLBGS 11 ; 0.00177138471 2.15759225e-09
NL: NLBGS 12 ; 0.000266969816 3.25176119e-10
NL: NLBGS 13 ; 5.17156336e-05 6.29909749e-11
NL: NLBGS 14 ; 7.54410755e-06 9.18891748e-12
NL: NLBGS 15 ; 1.49707166e-06 1.82347188e-12
NL: NLBGS 16 ; 2.16811937e-07 2.64082529e-13
NL: NLBGS 17 ; 5.99652506e-08 7.30392211e-14
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 2643519.81 1
NL: NLBGS 1 ; 152783.303 0.0577954069
NL: NLBGS 2 ; 139072.221 0.0526087306
NL: NLBGS 3 ; 3846.22296 0.00145496279
NL: NLBGS 4 ; 3201.98643 0.00121125872
NL: NLBGS 5 ; 1144.22212 0.000432840381
NL: NLBGS 6 ; 207.230834 7.83920109e-05
NL: NLBGS 7 ; 160.732433 6.08024319e-05
NL: NLBGS 8 ; 19.6716273 7.44145257e-06
NL: NLBGS 9 ; 14.7573977 5.58248046e-06
NL: NLBGS 10 ; 1.84642578 6.98472461e-07
NL: NLBGS 11 ; 1.38477011 5.23835723e-07
NL: NLBGS 12 ; 0.174865425 6.614871e-08
NL: NLBGS 13 ; 0.131196694 4.96295485e-08
NL: NLBGS 14 ; 0.0166185076 6.2865077e-09
NL: NLBGS 15 ; 0.0124709503 4.71755507e-09
NL: NLBGS 16 ; 0.00158110504 5.98105994e-10
NL: NLBGS 17 ; 0.00118664105 4.48886764e-10
NL: NLBGS 18 ; 0.000150468505 5.6919757e-11
NL: NLBGS 19 ; 0.000112934756 4.27213579e-11
NL: NLBGS 20 ; 1.43202997e-05 5.41713351e-12
NL: NLBGS 21 ; 1.07475439e-05 4.06561883e-12
NL: NLBGS 22 ; 1.37031842e-06 5.18368889e-13
NL: NLBGS 23 ; 1.02993416e-06 3.89607128e-13
NL: NLBGS 24 ; 1.81166279e-07 6.85322192e-14
NL: NLBGS 25 ; 1.67346209e-07 6.33043145e-14
NL: NLBGS 26 ; 1.3232202e-07 5.00552405e-14
NL: NLBGS 27 ; 9.61467552e-08 3.63707338e-14
NL: NLBGS Converged

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 542999.156 1
NL: NLBGS 1 ; 29096.2031 0.053584251
NL: NLBGS 2 ; 7179.03524 0.0132210799
NL: NLBGS 3 ; 1170.32483 0.0021552977
NL: NLBGS 4 ; 157.489206 0.000290035821
NL: NLBGS 5 ; 26.4408076 4.86940123e-05
NL: NLBGS 6 ; 3.48199734 6.41252809e-06
NL: NLBGS 7 ; 0.589012427 1.08473912e-06
NL: NLBGS 8 ; 0.0773432556 1.42437156e-07
NL: NLBGS 9 ; 0.0130500337 2.40332486e-08
NL: NLBGS 10 ; 0.00172398313 3.17492782e-09
NL: NLBGS 11 ; 0.000288864888 5.31980363e-10
NL: NLBGS 12 ; 3.85297259e-05 7.09572482e-11
NL: NLBGS 13 ; 6.40078913e-06 1.17878436e-11
NL: NLBGS 14 ; 8.62281161e-07 1.58799724e-12
NL: NLBGS 15 ; 1.48759854e-07 2.73959642e-13
NL: NLBGS 16 ; 5.59753646e-08 1.03085546e-13
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 1816447.67 1
NL: NLBGS 1 ; 86271.2018 0.0474944603
NL: NLBGS 2 ; 73041.1154 0.0402109659
NL: NLBGS 3 ; 1397.40737 0.000769307806
NL: NLBGS 4 ; 721.305276 0.000397096644
NL: NLBGS 5 ; 170.454182 9.38393022e-05
NL: NLBGS 6 ; 86.1779318 4.74431128e-05
NL: NLBGS 7 ; 19.8882064 1.09489564e-05
NL: NLBGS 8 ; 10.2731404 5.65562146e-06
NL: NLBGS 9 ; 2.26341175 1.24606494e-06
NL: NLBGS 10 ; 1.17978817 6.49502977e-07
NL: NLBGS 11 ; 0.253753664 1.39697756e-07
NL: NLBGS 12 ; 0.132912018 7.31713994e-08
NL: NLBGS 13 ; 0.0282302361 1.5541453e-08
NL: NLBGS 14 ; 0.014825257 8.16167579e-09
NL: NLBGS 15 ; 0.00312817686 1.72213982e-09
NL: NLBGS 16 ; 0.00164511417 9.05676611e-10
NL: NLBGS 17 ; 0.000345916468 1.90435691e-10
NL: NLBGS 18 ; 0.000182060745 1.00229006e-10
NL: NLBGS 19 ; 3.8210763e-05 2.10359834e-11
NL: NLBGS 20 ; 2.0121441e-05 1.10773579e-11
NL: NLBGS 21 ; 4.21994081e-06 2.32318325e-12
NL: NLBGS 22 ; 2.22642024e-06 1.22570018e-12
NL: NLBGS 23 ; 4.83419004e-07 2.66134286e-13
NL: NLBGS 24 ; 2.74420382e-07 1.51075303e-13
NL: NLBGS 25 ; 1.24653897e-07 6.86250965e-14
NL: NLBGS 26 ; 1.27271699e-07 7.00662623e-14
NL: NLBGS 27 ; 1.32742568e-07 7.30781126e-14
NL: NLBGS 28 ; 1.67579898e-07 9.22569365e-14
NL: NLBGS 29 ; 1.49524706e-07 8.23171009e-14
NL: NLBGS 30 ; 1.19178813e-07 6.56109258e-14
NL: NLBGS 31 ; 1.545016e-07 8.50570057e-14
NL: NLBGS 32 ; 1.27186888e-07 7.00195716e-14
NL: NLBGS 33 ; 1.54680259e-07 8.51553619e-14
NL: NLBGS 34 ; 1.30473074e-07 7.18286993e-14
NL: NLBGS 35 ; 1.30671566e-07 7.1937974e-14
NL: NLBGS 36 ; 1.30663356e-07 7.19334544e-14
NL: NLBGS 37 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 38 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 39 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 40 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 41 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 42 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 43 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 44 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 45 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 46 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 47 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 48 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 49 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 50 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 51 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 52 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 53 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 54 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 55 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 56 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 57 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 58 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 59 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 60 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 61 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 62 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 63 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 64 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 65 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 66 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 67 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 68 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 69 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 70 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 71 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 72 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 73 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 74 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 75 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 76 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 77 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 78 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 79 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 80 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 81 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 82 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 83 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 84 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 85 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 86 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 87 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 88 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 89 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 90 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 91 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 92 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 93 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 94 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 95 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 96 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 97 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 98 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 99 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS 100 ; 1.30663314e-07 7.19334315e-14
NL: NLBGS Failed to Converge in 100 iterations

==================
AS_point_0.coupled
==================
NL: NLBGS 0 ; 296612.202 1
NL: NLBGS 1 ; 17585.952 0.0592893749
NL: NLBGS 2 ; 4010.47943 0.0135209523
NL: NLBGS 3 ; 627.0971 0.0021141986
NL: NLBGS 4 ; 72.1394044 0.000243211183
NL: NLBGS 5 ; 11.7061324 3.94661189e-05
NL: NLBGS 6 ; 1.29952935 4.38124035e-06
NL: NLBGS 7 ; 0.214080622 7.21752579e-07
NL: NLBGS 8 ; 0.0234201249 7.89587372e-08
NL: NLBGS 9 ; 0.00387688664 1.30705568e-08
NL: NLBGS 10 ; 0.000422525432 1.42450455e-09
NL: NLBGS 11 ; 6.99399282e-05 2.35795856e-10
NL: NLBGS 12 ; 7.63437701e-06 2.57385804e-11
NL: NLBGS 13 ; 1.26130468e-06 4.2523695e-12
NL: NLBGS 14 ; 1.45935896e-07 4.9200908e-13
NL: NLBGS 15 ; 5.04733409e-08 1.70166098e-13
NL: NLBGS Converged

==================
AS_point_1.coupled
==================
NL: NLBGS 0 ; 973025.348 1
NL: NLBGS 1 ; 56097.0964 0.0576522457
NL: NLBGS 2 ; 47627.6829 0.0489480393
NL: NLBGS 3 ; 840.764854 0.000864072921
NL: NLBGS 4 ; 774.149011 0.000795610323
NL: NLBGS 5 ; 75.2778763 7.73647639e-05
NL: NLBGS 6 ; 40.3207784 4.14385694e-05
NL: NLBGS 7 ; 6.74513209 6.93212372e-06
NL: NLBGS 8 ; 3.06317787 3.14809668e-06
NL: NLBGS 9 ; 0.649833594 6.67848577e-07
NL: NLBGS 10 ; 0.287577203 2.9554955e-07
NL: NLBGS 11 ; 0.0646464732 6.64386322e-08
NL: NLBGS 12 ; 0.0282586927 2.90420931e-08
NL: NLBGS 13 ; 0.00648831717 6.66818926e-09
NL: NLBGS 14 ; 0.0028224369 2.90068178e-09
NL: NLBGS 15 ; 0.000653220833 6.71329718e-10
NL: NLBGS 16 ; 0.000283659792 2.91523538e-10
NL: NLBGS 17 ; 6.58361261e-05 6.76612653e-11
NL: NLBGS 18 ; 2.8573005e-05 2.93651189e-11
NL: NLBGS 19 ; 6.63831024e-06 6.82234051e-12
NL: NLBGS 20 ; 2.88383527e-06 2.96378227e-12
NL: NLBGS 21 ; 6.87372082e-07 7.06427724e-13
NL: NLBGS 22 ; 3.55866865e-07 3.65732368e-13
NL: NLBGS 23 ; 1.75077602e-07 1.79931184e-13
NL: NLBGS 24 ; 1.38198067e-07 1.42029257e-13
NL: NLBGS 25 ; 1.75408162e-07 1.80270908e-13
NL: NLBGS 26 ; 1.50014895e-07 1.54173677e-13
NL: NLBGS 27 ; 1.38917725e-07 1.42768866e-13
NL: NLBGS 28 ; 1.45485421e-07 1.49518634e-13
NL: NLBGS 29 ; 1.69243527e-07 1.73935373e-13
NL: NLBGS 30 ; 1.67890851e-07 1.72545198e-13
NL: NLBGS 31 ; 1.57137785e-07 1.61494031e-13
NL: NLBGS 32 ; 1.74632218e-07 1.79473452e-13
NL: NLBGS 33 ; 1.74029626e-07 1.78854155e-13
NL: NLBGS 34 ; 1.71089031e-07 1.75832039e-13
NL: NLBGS 35 ; 1.70632911e-07 1.75363274e-13
NL: NLBGS 36 ; 1.70633011e-07 1.75363378e-13
NL: NLBGS 37 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 38 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 39 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 40 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 41 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 42 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 43 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 44 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 45 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 46 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 47 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 48 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 49 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 50 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 51 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 52 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 53 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 54 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 55 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 56 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 57 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 58 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 59 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 60 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 61 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 62 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 63 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 64 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 65 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 66 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 67 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 68 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 69 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 70 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 71 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 72 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 73 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 74 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 75 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 76 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 77 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 78 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 79 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 80 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 81 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 82 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 83 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 84 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 85 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 86 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 87 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 88 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 89 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 90 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 91 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 92 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 93 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 94 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 95 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 96 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 97 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 98 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 99 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS 100 ; 1.7063299e-07 1.75363355e-13
NL: NLBGS Failed to Converge in 100 iterations
Optimization terminated successfully.    (Exit mode 0)
            Current function value: 0.971339609714
            Iterations: 13
            Function evaluations: 19
            Gradient evaluations: 13
Optimization Complete
-----------------------------------</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;The fuel burn value is&#39;</span><span class="p">,</span> <span class="n">prob</span><span class="p">[</span><span class="s1">&#39;AS_point_0.fuelburn&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;[kg]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>The fuel burn value is 97133.96097139956 [kg]</pre></div></div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;The wingbox mass (excluding the wing_weight_ratio) is&#39;</span><span class="p">,</span> <span class="n">prob</span><span class="p">[</span><span class="s1">&#39;wing.structural_mass&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">grav_constant</span><span class="o">/</span><span class="n">surf_dict</span><span class="p">[</span><span class="s1">&#39;wing_weight_ratio&#39;</span><span class="p">],</span> <span class="s1">&#39;[kg]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell border-box-sizing code_cell rendered"><div class="output_area"><pre>The wingbox mass (excluding the wing_weight_ratio) is 2419.0987744272256 [kg]</pre></div></div><p>The following are the visualization results for this problem using the <cite>plot_wingbox.py</cite> visualization script (located in the <cite>utils</cite> directory).
This visualization script requires the <cite>.db</cite> file as an argument.
For example, to use it for this example problem, from the example script’s (wingbox_mpt_opt_example.py) location in the OpenAeroStruct <cite>docs</cite> directory, we would use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">../</span><span class="n">utils</span><span class="o">/</span><span class="n">plot_wingbox</span><span class="o">.</span><span class="n">py</span> <span class="n">aerostruct</span><span class="o">.</span><span class="n">db</span>
</pre></div>
</div>
<img alt="_images/wingbox_opt.png" src="_images/wingbox_opt.png" />
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="more_examples.html" title="More Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="aerostructural_walkthrough.html" title="Aerostructural Walkthrough"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenAeroStruct 2.1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, John Jasa, Dr. John Hwang, Justin S. Gray.
      Last updated on Feb 04, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
  </body>
</html>